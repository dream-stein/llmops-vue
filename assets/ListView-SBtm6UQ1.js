import{a as L,o as l,c as d,b as p,e,w as a,u as t,i as W,t as g,k as A,l as I,f as s,g as r}from"./index-T-crqSHV.js";import{h as J}from"./moment-C5S46NFB.js";import{c as K,d as O,e as Q}from"./use-dataset-BCvgfPmx.js";import"./request-RJC2F4Zf.js";const U={class:"p-6"},X={class:"flex items-center w-full gap-2 mb-6"},Z={class:"flex items-center gap-3"},$={class:"flex flex-col justify-between h-[40px]"},ee={key:1,class:"text-gray-700"},te={key:2,class:"flex items-center gap-2"},ae={key:3,class:"flex items-center gap-2"},se={class:"flex items-center justify-between mb-6"},ne={class:""},oe={class:"line-clamp-1"},le={key:0,class:"w-2 h-2 bg-green-500 rounded-sm border border-green-700"},re={key:1,class:"w-2 h-2 bg-gray-500 rounded-sm border border-gray-700"},ce={key:2,class:"text-gray-700"},de={key:3,class:"text-gray-700"},he=L({__name:"ListView",setup(ie){var w,k;const c=A(),f=I(),{dataset:i,loadDataset:B}=K((w=c.params)==null?void 0:w.dataset_id),{loading:S,documents:V,paginator:y,loadDocuments:Y}=O((k=c.params)==null?void 0:k.dataset_id),{handleDelete:N}=Q();return(_e,o)=>{var z,D,C;const P=s("icon-left"),m=s("a-button"),j=s("router-link"),G=s("a-avatar"),h=s("a-skeleton-line"),x=s("a-tag"),H=s("a-input-search"),b=s("a-space"),_=s("a-table-column"),M=s("a-divider"),R=s("a-switch"),T=s("icon-more"),v=s("a-doption"),E=s("a-dropdown"),F=s("a-table");return l(),d("div",U,[p("div",X,[e(j,{to:{name:"space-datasets-list"}},{default:a(()=>[e(m,{size:"mini",type:"text",class:"!text-gray-700"},{icon:a(()=>[e(P)]),_:1})]),_:1}),p("div",Z,[e(G,{size:40,shape:"square",class:"rounded-lg","image-url":t(i).icon},null,8,["image-url"]),p("div",$,[(z=t(i))!=null&&z.name?(l(),d("div",ee,"知识库 / "+g(t(i).name),1)):(l(),W(h,{key:0,widths:[100]})),(D=t(i))!=null&&D.name?(l(),d("div",ae,[e(x,{size:"small",class:"rounded h-[18px] leading-[18px] bg-gray-200 text-gray-500"},{default:a(()=>[r(g(t(i).document_count)+" 文档",1)]),_:1}),e(x,{size:"small",class:"rounded h-[18px] leading-[18px] bg-gray-200 text-gray-500"},{default:a(()=>[r(g(t(i).hit_count)+" 命中",1)]),_:1}),e(x,{size:"small",class:"rounded h-[18px] leading-[18px] bg-gray-200 text-gray-500"},{default:a(()=>[r(g(t(i).related_app_count)+" 关联应用",1)]),_:1})])):(l(),d("div",te,[e(h,{widths:[60],"line-height":18}),e(h,{widths:[60],"line-height":18}),e(h,{widths:[60],"line-height":18})]))])])]),p("div",se,[e(H,{"default-value":((C=t(c).query)==null?void 0:C.search_word)||"",placeholder:"请输入关键词搜素文档",class:"w-[240px] bg-white rounded-lg border-gray-200",onSearch:o[0]||(o[0]=n=>{t(f).push({path:t(c).path,query:{search_word:n,current_page:1}})})},null,8,["default-value"]),e(b,{size:12},{default:a(()=>[e(m,{class:"rounded-lg"},{default:a(()=>o[2]||(o[2]=[r("召回测试")])),_:1}),e(m,{type:"primary",class:"rounded-lg"},{default:a(()=>o[3]||(o[3]=[r("添加文件")])),_:1})]),_:1})]),p("div",ne,[e(F,{hoverable:"",pagination:{total:t(y).total_record,current:t(y).current_page,defaultCurrent:1,pageSize:t(y).page_size,defaultPageSize:10,showTotal:!0},loading:t(S),data:t(V),bordered:{wrapper:!1},onPageChange:o[1]||(o[1]=n=>{var u;t(f).push({path:t(c).path,query:{current_page:n,search_word:((u=t(c).query)==null?void 0:u.search_word)||""}})})},{columns:a(()=>[e(_,{title:"#","data-index":"position",align:"center",width:80,"header-cell-class":"rounded-tl-lg !bg-gray-200 text-gray-700","cell-class":"bg-transparent text-gray-700"}),e(_,{title:"文档名","data-index":"name",width:400,"header-cell-class":"!bg-gray-200 text-gray-700","cell-class":"bg-transparent text-gray-700"},{cell:a(({record:n})=>[p("div",oe,g(n.name),1)]),_:1}),e(_,{title:"字符数","data-index":"character_count","header-cell-class":"!bg-gray-200 text-gray-700","cell-class":"bg-transparent text-gray-700"},{cell:a(({record:n})=>[r(g((n.character_count/1e3).toFixed(1))+"k ",1)]),_:1}),e(_,{title:"召回次数","data-index":"hit_count","header-cell-class":"!bg-gray-200 text-gray-700","cell-class":"bg-transparent text-gray-700"}),e(_,{title:"上传时间","data-index":"created_at","header-cell-class":"!bg-gray-200 text-gray-700","cell-class":"bg-transparent text-gray-700"},{cell:a(({record:n})=>[r(g(t(J)(n.created_at*1e3).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(_,{title:"状态","data-index":"enabled","header-cell-class":"!bg-gray-200 text-gray-700","cell-class":"bg-transparent text-gray-700"},{cell:a(({record:n})=>[e(b,null,{default:a(()=>[n.enabled?(l(),d("div",le)):(l(),d("div",re)),n.enabled?(l(),d("div",ce,"可用")):(l(),d("div",de,"已禁用"))]),_:2},1024)]),_:1}),e(_,{title:"操作","data-index":"operator","header-cell-class":"rounded-tr-lg !bg-gray-200 text-gray-700","cell-class":"bg-transparent text-gray-700 !h-[40px]",width:100},{cell:a(({record:n})=>[e(b,{size:0},{split:a(()=>[e(M,{direction:"vertical"})]),default:a(()=>[e(R,{size:"small","checked-color":"#10b981",type:"round","unchecked-color":"#556581","default-checked":""}),e(E,{position:"br"},{content:a(()=>[e(v,null,{default:a(()=>o[4]||(o[4]=[r("重命名")])),_:1}),e(v,{class:"!text-red-700",onClick:()=>{var u;return t(N)((u=t(c).params)==null?void 0:u.dataset_id,n.id,async()=>{var q;await t(Y)(),await t(B)((q=t(c).params)==null?void 0:q.dataset_id)})}},{default:a(()=>o[5]||(o[5]=[r("删除")])),_:2},1032,["onClick"])]),default:a(()=>[e(m,{type:"text",size:"small",class:"!text-gray-700"},{icon:a(()=>[e(T)]),_:1})]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["pagination","loading","data"])])])}}});export{he as default};
