import{d as z,b as U,o as x,f as k,g as n,h as o,w as s,v as q,u as i,c as V,a as v,i as h,G as O,H as R,x as j,r as l,I as T,J as N,j as G}from"./index-KxwbAn6C.js";import{e as A,f as H,g as I,h as E,i as F}from"./use-app-CfKrPaG0.js";const J={class:"flex flex-col h-[calc(100vh-173px)]"},L={class:"flex items-center justify-between px-4 mb-4"},K={class:"flex flex-col"},Q={key:0,class:"mb-4 flex flex-col"},W={class:"max-h-[321px] overflow-scroll scrollbar-w-none mb-2 text-gray-700 whitespace-pre-line"},X={class:""},Y={class:"h-[50px] flex items-center gap-2 px-4 flex-1 border border-gray-200 rounded-full"},Z={class:"flex-1"},ee=z({__name:"PresetPromptTextarea",props:{app_id:{type:String,required:!0},preset_prompt:{type:String,required:!0}},emits:["update:preset_prompt"],setup(c,{emit:p}){const r=c,_=p,d=U(!1),f=U(""),{handleUpdateDraftAppConfig:t}=A(),{loading:m,optimize_prompt:u,handleOptimizePrompt:e}=H(),b=()=>{if(u.value.trim()===""){j.warning("优化prompt为空，请重新生成");return}_("update:preset_prompt",u.value),t(r.app_id,{preset_prompt:u.value}),d.value=!1},y=async()=>{if(f.value.trim()===""){j.warning("原始prompt不能为空");return}await e(u.value)};return(g,a)=>{const S=l("icon-sync"),C=l("a-button"),D=l("a-space"),w=l("icon-send"),B=l("a-card"),P=l("a-trigger"),M=l("a-textarea");return x(),k("div",J,[n("div",L,[a[8]||(a[8]=n("div",{class:"text-gray-700 font-bold"},"人设与回复逻辑",-1)),o(P,{"popup-visible":d.value,"onUpdate:popupVisible":a[2]||(a[2]=$=>d.value=$),trigger:["click"],position:"bl","popup-translate":[0,8]},{content:s(()=>[o(B,{class:"rounded-lg w-[422px]"},{default:s(()=>[n("div",K,[f.value?(x(),k("div",Q,[n("div",W,q(i(u)),1),i(m)?h("",!0):(x(),V(D,{key:0},{default:s(()=>[o(C,{size:"small",type:"primary",class:"rounded-lg",onClick:b},{default:s(()=>a[6]||(a[6]=[v(" 替换 ")])),_:1}),o(C,{size:"small",class:"rounded-lg",onClick:a[0]||(a[0]=$=>d.value=!1)},{default:s(()=>a[7]||(a[7]=[v("退出")])),_:1})]),_:1}))])):h("",!0),n("div",X,[n("div",Y,[O(n("input",{"onUpdate:modelValue":a[1]||(a[1]=$=>f.value=$),type:"text",class:"flex-1 outline-0",placeholder:"你希望如何编写或优化提示词"},null,512),[[R,f.value]]),o(C,{loading:i(m),type:"text",shape:"circle",onClick:y},{icon:s(()=>[o(w,{size:16,class:"!text-blue-700"})]),_:1},8,["loading"])])])])]),_:1})]),default:s(()=>[o(C,{size:"mini",class:"rounded-lg px-2"},{icon:s(()=>[o(S)]),default:s(()=>[a[5]||(a[5]=v(" 优化 "))]),_:1})]),_:1},8,["popup-visible"])]),n("div",Z,[o(M,{class:"h-full resize-none !bg-transparent !border-0 text-gray-700 px-1 preset-prompt-textarea",placeholder:"请在这里输入Agent的人设与回复逻辑(预设prompt)","max-length":2e3,"show-word-limit":"","model-value":r.preset_prompt,"onUpdate:modelValue":a[3]||(a[3]=$=>_("update:preset_prompt",$)),onBlur:a[4]||(a[4]=async()=>{await i(t)(r.app_id,{preset_prompt:r.preset_prompt})})},null,8,["model-value"])])])}}}),te={class:""},oe={class:"flex items-center justify-between border-b h-[64px] px-4"},se={class:"flex items-center justify-between"},ne={class:"pt-6"},ae={class:"flex items-center justify-between"},le=z({__name:"PreViewDebugHeader",props:{app_id:{type:String,required:!0},long_term_memory:{type:Object,required:!0}},setup(c){const p=c,{debug_conversation_summary:r,loadDebugConversationSummary:_}=I(),{loading:d,handleUpdateDebugConversationSummary:f}=E(),t=U(!1),m=async()=>{await _(p.app_id),t.value=!0};return(u,e)=>{var D;const b=l("icon-save"),y=l("a-button"),g=l("icon-close"),a=l("a-textarea"),S=l("a-space"),C=l("a-modal");return x(),k("div",te,[n("div",oe,[e[6]||(e[6]=n("div",{class:"text-lg text-gray-700"},"预览与调试",-1)),o(y,{disabled:!((D=p.long_term_memory)!=null&&D.enable),size:"mini",type:"text",class:"rounded-lg px-1 !text-blue-700",onClick:m},{icon:s(()=>[o(b)]),default:s(()=>[e[5]||(e[5]=v(" 长期记忆 "))]),_:1},8,["disabled"])]),o(C,{width:520,visible:t.value,"onUpdate:visible":e[4]||(e[4]=w=>t.value=w),"hide-title":"",footer:!1,"modal-class":"rounded-xl"},{default:s(()=>[n("div",se,[e[7]||(e[7]=n("div",{class:"text-lg font-bold text-gray-700"},"长期记忆",-1)),o(y,{type:"text",class:"!text-gray-700",size:"small",onClick:e[0]||(e[0]=w=>t.value=!1)},{icon:s(()=>[o(g)]),_:1})]),n("div",ne,[o(a,{"model-value":i(r),"onUpdate:modelValue":e[1]||(e[1]=w=>T(r)?r.value=w:null),placeholder:"请输入当前调试会话长期记忆","show-word-limit":"","max-length":2e3,"auto-size":{minRows:8,maxRows:8}},null,8,["model-value"]),n("div",ae,[e[10]||(e[10]=n("div",{class:""},null,-1)),o(S,{size:16},{default:s(()=>[o(y,{class:"rounded-lg",onClick:e[2]||(e[2]=w=>t.value=!1)},{default:s(()=>e[8]||(e[8]=[v("取消")])),_:1}),o(y,{loading:i(d),type:"primary",class:"rounded-lg",onClick:e[3]||(e[3]=async()=>{await i(f)(p.app_id,i(r)),t.value=!1})},{default:s(()=>e[9]||(e[9]=[v(" 保存 ")])),_:1},8,["loading"])]),_:1})])])]),_:1},8,["visible"])])}}}),re={class:""},ie=z({__name:"LongTermMemoryAbilityItem",props:{app_id:{type:String,default:"",required:!0},long_term_memory:{type:Object,default:{enable:!1},required:!0}},emits:["update:long_term_memory"],setup(c,{emit:p}){const r=c,_=p,{handleUpdateDraftAppConfig:d}=A();return(f,t)=>{const m=l("icon-down"),u=l("a-button"),e=l("a-doption"),b=l("a-dropdown"),y=l("a-collapse-item");return x(),k("div",re,[o(y,{key:"long_term_memory",class:"app-ability-item"},{header:s(()=>t[2]||(t[2]=[n("div",{class:"text-gray-700 font-bold"},"长期记忆",-1)])),extra:s(()=>[o(b,{onSelect:t[1]||(t[1]=async g=>{var a;!!g!==((a=r.long_term_memory)==null?void 0:a.enable)&&(_("update:long_term_memory",{enable:!!g}),await i(d)(r.app_id,{long_term_memory:{enable:!!g}}))})},{content:s(()=>[o(e,{value:1,class:"text-xs py-1.5 text-gray-700"},{default:s(()=>t[3]||(t[3]=[v("开启")])),_:1}),o(e,{value:0,class:"text-xs py-1.5 text-red-700"},{default:s(()=>t[4]||(t[4]=[v("关闭")])),_:1})]),default:s(()=>[o(u,{size:"mini",class:"rounded-lg flex items-center gap-1 px-1",onClick:t[0]||(t[0]=N(()=>{},["stop"]))},{default:s(()=>{var g;return[v(q((g=r.long_term_memory)!=null&&g.enable?"开启":"关闭")+" ",1),o(m)]}),_:1})]),_:1})]),default:s(()=>[t[5]||(t[5]=n("div",{class:"text-xs text-gray-500 leading-[22px]"}," 总结聊天对话内容，并用于更好的相应用户的信息 ",-1))]),_:1})])}}}),pe={class:"flex flex-col h-[calc(100vh-141px)]"},de={class:"flex-1 overflow-scroll scrollbar-w-none"},me=z({__name:"AgentAppAbility",props:{app_id:{type:String,default:"",required:!0},draft_app_config:{type:Object,required:!0}},emits:["update:draft_app_config"],setup(c,{emit:p}){return(r,_)=>{const d=l("icon-down"),f=l("icon-right"),t=l("a-collapse");return x(),k("div",pe,[_[1]||(_[1]=n("div",{class:"p-4 text-gray-700 font-bold"},"应用能力",-1)),n("div",de,[o(t,{bordered:!1},{"expand-icon":s(({active:m})=>[m?(x(),V(d,{key:0})):(x(),V(f,{key:1}))]),default:s(()=>[o(ie,{long_term_memory:c.draft_app_config.long_term_memory,"onUpdate:long_term_memory":_[0]||(_[0]=m=>c.draft_app_config.long_term_memory=m),app_id:c.app_id},null,8,["long_term_memory","app_id"])]),_:1})])])}}}),_e={class:"flex-1 w-full min-h-0 bg-white"},ue={class:"flex-1 grid grid-cols-[26fr_14fr] h-full w-full"},ce={class:"bg-gray-50 flex flex-col h-full"},fe={class:"grid grid-cols-[13fr_13fr] overflow-hidden h-[calc(100vh-141px)]"},ge={class:"border-r py-4"},xe={class:"min-w-[404px]"},be=z({__name:"DetailView",setup(c){var d;const p=G(),{draftAppConfigForm:r,loadDraftAppConfig:_}=F((d=p.params)==null?void 0:d.app_id);return A(),(f,t)=>{var m,u,e;return x(),k("div",_e,[n("div",ue,[n("div",ce,[t[1]||(t[1]=n("div",{class:"flex items-center h-16 border-b p-4"},[n("div",{class:"text-lg text-gray-700"},"应用编排")],-1)),n("div",fe,[n("div",ge,[o(ee,{preset_prompt:i(r).preset_prompt,"onUpdate:preset_prompt":t[0]||(t[0]=b=>i(r).preset_prompt=b),app_id:(m=i(p).params)==null?void 0:m.app_id},null,8,["preset_prompt","app_id"])]),o(me,{draft_app_config:i(r),app_id:(u=i(p).params)==null?void 0:u.app_id},null,8,["draft_app_config","app_id"])])]),n("div",xe,[o(le,{app_id:(e=i(p).params)==null?void 0:e.app_id,long_term_memory:i(r).long_term_memory},null,8,["app_id","long_term_memory"])])])])}}});export{be as default};
