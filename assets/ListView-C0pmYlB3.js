import{m as I}from"./moment-S4F_B1I0.js";import{u as G,a as O,b as P,c as W,d as E,e as J}from"./use-app-E-db88JQ.js";import{d as N,b as V,e as $,r as a,o as m,c as v,w as t,g as i,t as g,h as e,a as y,u as n,l as K,m as Q,j as X,f as Y,n as Z,F as ee,i as H}from"./index-BsTDcwnH.js";const te={class:"flex items-center justify-between"},ae={class:"text-lg font-bold text-gray-700"},oe={class:"pt-6"},se={class:"flex items-center justify-between"},le=N({__name:"CreateOrUpdateAppModal",props:{app_id:{type:String,default:"",required:!1},visible:{type:Boolean,required:!0},callback:{type:Function,required:!1}},emits:["update:visible","update:app_id"],setup(z,{emit:F}){const d=z,u=F,{loading:b,handleCreateApp:M}=G(),{loading:j,handleUpdateApp:S}=O(),{app:f,loadApp:C}=P(),_={fileList:[],icon:"",name:"",description:""},r=V({..._}),h=V(),c=()=>u("update:visible",!1),o=async({errors:p})=>{p||(d.app_id?await S(d.app_id,r.value):await M(r.value),u("update:visible",!1),d.callback&&d.callback())};return $(()=>d.visible,async p=>{var s,x;(s=h.value)==null||s.resetFields(),p?d.app_id&&(await C(d.app_id),r.value={fileList:[{uid:"1",name:"应用图标",url:f.value.icon}],icon:f.value.icon,name:f.value.name,description:f.value.description}):(r.value=_,(x=h.value)==null||x.resetFields(),u("update:app_id",""))}),(p,s)=>{const x=a("icon-close"),q=a("a-button"),w=a("a-upload"),L=a("a-form-item"),B=a("a-input"),D=a("a-textarea"),k=a("a-space"),R=a("a-form"),U=a("a-modal");return m(),v(U,{width:520,visible:d.visible,"hide-title":"",footer:!1,"modal-class":"rounded-xl",onCancel:c},{default:t(()=>[i("div",te,[i("div",ae,g(d.app_id===""?"创建 AI 应用":"编辑 AI 应用"),1),e(q,{type:"text",class:"!text-gray-700",size:"small",onClick:c},{icon:t(()=>[e(x)]),_:1})]),i("div",oe,[e(R,{ref_key:"formRef",ref:h,model:r.value,layout:"vertical",onSubmit:o},{default:t(()=>[e(L,{field:"fileList","hide-label":"",rules:[{required:!0,message:"应用图标不能为空"}]},{default:t(()=>[e(w)]),_:1}),e(L,{field:"name",label:"应用名称","asterisk-position":"end",rules:[{required:!0,message:"应用名称不能为空"}]},{default:t(()=>[e(B,{"model-value":r.value.name,"onUpdate:modelValue":s[0]||(s[0]=A=>r.value.name=A),placeholder:"请输入应用名称"},null,8,["model-value"])]),_:1}),e(L,{field:"content",label:"应用描述"},{default:t(()=>[e(D,{"model-value":r.value.description,"onUpdate:modelValue":s[1]||(s[1]=A=>r.value.description=A),"auto-size":{minRows:8,maxRows:8},"max-length":800,"show-word-limit":"",placeholder:"请输入关于该应用的描述信息"},null,8,["model-value"])]),_:1}),i("div",se,[s[4]||(s[4]=i("div",{class:""},null,-1)),e(k,{size:16},{default:t(()=>[e(q,{class:"rounded-lg",onClick:c},{default:t(()=>s[2]||(s[2]=[y("取消")])),_:1}),e(q,{loading:n(b)||n(j),type:"primary","html-type":"submit",class:"rounded-lg"},{default:t(()=>s[3]||(s[3]=[y(" 保存 ")])),_:1},8,["loading"])]),_:1})])]),_:1},8,["model"])])]),_:1},8,["visible"])}}}),ne={class:"flex items-center gap-3 mb-3"},ie={class:"flex flex-1 justify-between"},de={class:"flex flex-col"},re={class:"text-xs text-gray-500 line-clamp-1"},ce={class:"leading-[18px] text-gray-500 h-[72px] line-clamp-4 mb-2 break-all"},pe={class:"flex items-center gap-1.5"},ue={class:"text-xs text-gray-400"},ve=N({__name:"ListView",props:{createType:{type:String,default:"",required:!0}},setup(z){const F=X(),d=z,u=V(!1),b=V(""),M=K(),{handleCopyApp:j}=W(),{loading:S,apps:f,paginator:C,loadApps:_}=E(),{handleDeleteApp:r}=J(),h=async c=>{const{scrollTop:o,scrollHeight:p,clientHeight:s}=c.target;if(o+s>=p-10){if(S.value)return;await _()}};return Q(async()=>{await _(!0)}),$(()=>d.createType,c=>{c==="app"&&(b.value="",u.value=!0)}),$(()=>{var c;return(c=F.query)==null?void 0:c.search_word},async()=>await _(!0)),(c,o)=>{const p=a("a-avatar"),s=a("router-link"),x=a("icon-more"),q=a("a-button"),w=a("a-doption"),L=a("a-dropdown"),B=a("icon-user"),D=a("a-card"),k=a("a-col"),R=a("a-empty"),U=a("a-row"),A=a("a-spin"),T=a("a-space");return m(),v(A,{loading:n(S),class:"block h-full w-full scrollbar-w-none overflow-scroll",onScroll:h},{default:t(()=>[e(U,{gutter:[20,20],class:"flex-1"},{default:t(()=>[(m(!0),Y(ee,null,Z(n(f),l=>(m(),v(k,{key:l.id,span:6},{default:t(()=>[e(D,{hoverable:"",class:"cursor-pointer rounded-lg"},{default:t(()=>[i("div",ne,[e(p,{size:40,shape:"square","image-url":l.icon},null,8,["image-url"]),i("div",ie,[i("div",de,[e(s,{to:{name:"space-apps-detail",params:{app_id:l.id}},class:"text-base text-gray-900 font-bold"},{default:t(()=>[y(g(l.name),1)]),_:2},1032,["to"]),i("div",re,g(l.model_config.provider)+" · "+g(l.model_config.model),1)]),e(L,{position:"br"},{content:t(()=>[e(s,{to:{name:"space-apps-analysis",params:{app_id:l.id}}},{default:t(()=>[e(w,null,{default:t(()=>o[2]||(o[2]=[y("分析")])),_:1})]),_:2},1032,["to"]),e(w,{onClick:()=>{b.value=l.id,u.value=!0}},{default:t(()=>o[3]||(o[3]=[y(" 编辑应用 ")])),_:2},1032,["onClick"]),e(w,{onClick:async()=>await n(j)(l.id)},{default:t(()=>o[4]||(o[4]=[y("创建副本")])),_:2},1032,["onClick"]),e(w,{onClick:async()=>await n(r)(l.id,async()=>await n(_)(!0))},{default:t(()=>o[5]||(o[5]=[y(" 删除 ")])),_:2},1032,["onClick"])]),default:t(()=>[e(q,{type:"text",size:"small",class:"rounded-lg !text-gray-700"},{icon:t(()=>[e(x)]),_:1})]),_:2},1024)])]),i("div",ce,g(l.description.trim()===""?l.preset_prompt:l.description),1),i("div",pe,[e(p,{size:18,class:"bg-blue-700"},{default:t(()=>[e(B)]),_:1}),i("div",ue,g(n(M).account.name)+" · 最近编辑 "+g(n(I)(l.created_at*1e3).format("MM-DD HH:mm")),1)])]),_:2},1024)]),_:2},1024))),128)),n(f).length===0?(m(),v(k,{key:0,span:24},{default:t(()=>[e(R,{description:"没有可用的Agent智能体",class:"h-[400px] flex flex-col items-center justify-center"})]),_:1})):H("",!0)]),_:1}),n(C).total_page>=2?(m(),v(U,{key:0},{default:t(()=>[n(C).current_page<=n(C).total_page?(m(),v(k,{key:0,span:24,align:"center"},{default:t(()=>[e(T,{class:"my-4"},{default:t(()=>[e(A),o[6]||(o[6]=i("div",{class:"text-gray-400"},"加载中",-1))]),_:1})]),_:1})):(m(),v(k,{key:1,span:24,align:"center"},{default:t(()=>o[7]||(o[7]=[i("div",{class:"text-gray-400 my-4"},"数据已加载完成",-1)])),_:1}))]),_:1})):H("",!0),e(le,{visible:u.value,"onUpdate:visible":o[0]||(o[0]=l=>u.value=l),app_id:b.value,"onUpdate:app_id":o[1]||(o[1]=l=>b.value=l),callback:async()=>await n(_)(!0)},null,8,["visible","app_id","callback"])]),_:1},8,["loading"])}}});export{ve as default};
