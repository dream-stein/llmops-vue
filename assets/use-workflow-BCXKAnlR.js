import{g as i,p as u,r as o,B as k,M as c,P as h}from"./index-BcbagPpT.js";const W=e=>i("/workflows",{params:e}),v=e=>u("/workflows",{body:e}),y=(e,s)=>u(`/workflows/${e}`,{body:s}),_=e=>i(`/workflows/${e}`),m=e=>u(`/workflows/${e}/delete`),b=e=>i(`/workflows/${e}/draft-graph`),P=e=>u(`/workflows/${e}/publish`),G=e=>u(`/workflows/${e}/cancel-publish`),D=()=>{const e=o(!1),s=o([]),t={current_page:1,page_size:20,total_page:0,total_record:0},a=o({...t});return{loading:e,workflows:s,paginator:a,loadWorkflows:async(w="",f="",r=!1)=>{if(r)a.value=t;else if(a.value.current_page>a.value.total_page)return;try{e.value=!0;const n=(await W({current_page:a.value.current_page,page_size:a.value.page_size,search_word:w,status:f})).data;a.value=n.paginator,a.value.current_page<=a.value.total_page&&(a.value.current_page+=1),r?s.value=n.list:s.value.push(...n.list)}finally{e.value=!1}}}},$=()=>{const e=o(!1),s=k();return{loading:e,handleCreateWorkflow:async a=>{try{e.value=!0;const l=await v(a);c.success("创建工作流成功"),await s.push({name:"space-workflows-detail",params:{workflow_id:l.data.id}})}finally{e.value=!1}}}},z=()=>{const e=o(!1);return{loading:e,handleUpdateWorkflow:async(t,a)=>{try{e.value=!0;const l=await y(t,a);c.success(l.message)}finally{e.value=!1}}}},M=()=>{const e=o(!1),s=o({});return{loading:e,workflow:s,loadWorkflow:async a=>{try{e.value=!0;const l=await _(a);s.value=l.data}finally{e.value=!1,s.value={name:"工作流测试组件",tool_call_name:"GongZuoLiuCeShiZuJian",icon:"https://img2.baidu.com/it/u=363858033,1221485415&fm=253&app=138&f=JPEG?w=800&h=1067",description:"当需要使用工作流进行测试的时候，可以使用该组件",updated_at:1755316038}}}}},U=()=>({handleDeleteWorkflow:(s,t)=>{h.warning({title:"要删除该工作流吗?",content:"删除工作流后，发布的WebApp、开放API以及关联的社交媒体平台均无法使用该工作流，如果需要暂停工作流，可使用取消发布功能。",hideCancel:!1,onOk:async()=>{try{const a=await m(s);c.success(a.message)}finally{t&&t()}}})}}),A=()=>{const e=o(!1),s=o([]),t=o([]);return{loading:e,nodes:s,edges:t,loadDraftGraph:async l=>{try{e.value=!0;const f=(await b(l)).data;s.value=f.nodes.map(r=>{const{id:d,node_type:n,position:p,...g}=r;return{id:d,type:n,position:p,data:g}}),t.value=f.edges.map(r=>({...r,animated:!0,style:{strokeWidth:2,stroke:"#9ca3af"}}))}finally{e.value=!1}}}},J=()=>{const e=o(!1);return{loading:e,handlePublishWorkflow:async t=>{try{e.value=!0;const a=await P(t);c.success(a.message)}finally{e.value=!1}}}},Z=()=>{const e=o(!1);return{loading:e,handleCancelPublish:async t=>{try{e.value=!0;const a=await G(t);c.success(a.message)}finally{e.value=!1}}}};export{z as a,M as b,D as c,U as d,A as e,J as f,Z as g,$ as u};
