import{k as w,r as l,p as g,q as f,h as D,v as _,M as v}from"./index-ChrAzW4i.js";import{g as m,p as h}from"./request-CqNJTr02.js";const z=(t=1,a=10,e="")=>m("/datasets",{params:{current_page:t,page_size:a,search_word:e}}),O=t=>h("/datasets",{body:t}),M=(t,a)=>h(`/datasets/${t}`,{body:a}),P=t=>h(`/datasets/${t}/delete`),q=t=>m(`/datasets/${t}`),L=(t,a={current_page:1,page_size:20,search_word:""})=>m(`/datasets/${t}/documents`,{params:a}),U=()=>{const t=w(),a=l(!1),e=g([]),c={current_page:1,page_size:20,total_page:0,total_record:0},s=g({...c}),n=async(r=!1)=>{var o;if(r)i();else if(s.current_page>s.total_page)return;try{a.value=!0;const u=(await z(s.current_page,s.page_size,String(((o=t.query)==null?void 0:o.search_word)??""))).data;d(u),s.current_page<=s.total_page&&(s.current_page+=1),r?e.splice(0,e.length,...u.list):e.push(...u.list)}finally{Object.assign(e,[{id:"46db30d1-3199-4e79-a0cd-abf12fa6858f",name:"慕课LLMOps知识库",icon:"https://cdn.imooc.com/dataset.png",description:"JavaScript是一种高级编程语言，用于创建交互式网页和动态效果，JavaScript在前端开发中扮演着非常重要的角色，因此学习 JavaScript 对于初级前端工程师来说非常必要。JavaScrip...",document_count:10,character_count:14651,related_app_count:2,updated_at:1721460914,created_at:1721460914}]),a.value=!1}},i=()=>{Object.assign(s,{...c})},d=r=>{s.current_page=r.current_page,s.page_size=r.page_size,s.total_page=r.total_page,s.total_record=r.total_record};return f(async()=>{await n(!0)}),D(()=>{var r;return(r=t.query)==null?void 0:r.search_word},async()=>{await n(!0)}),{loading:a,datasets:e,paginator:s,loadDatasets:n}},W=()=>({handleDelete:(a,e)=>{v.warning({title:"要删除知识库吗?",content:"删除知识库后，关联该知识库的应用将无法再使用该知识库，所有的提示配置和文档都将被永久删除",hideCancel:!1,onOk:async()=>{try{const c=await P(a);_.success(c.message)}finally{e&&e()}}})}}),$=()=>{const t=l(!1),e=g({...{fileList:[],icon:"",name:"",description:""}}),c=l(),s=l(!1);return{loading:t,form:e,formRef:c,saveDataset:async d=>{try{if(t.value=!0,d!==void 0&&d!==""){const r=await M(d,{icon:e.icon,name:e.name,description:e.description});_.success(r.message)}else{const r=await O({icon:e.icon,name:e.name,description:e.description});_.success(r.message)}}finally{t.value=!1}},showUpdateModal:s,updateShowUpdateModal:(d,r)=>{s.value=d,r&&r()}}},G=t=>{const a=l(!1),e=g({}),c=async s=>{try{a.value=!0;const i=(await q(s)).data;Object.assign(e,{...i})}finally{Object.assign(e,{id:"46db30d1-3199-4e79-a0cd-abf12fa6858f",name:"慕课LLMOps知识库",icon:"https://cdn.imooc.com/dataset.png",description:"",document_count:10,character_count:14651,hit_count:10,related_app_count:2,updated_at:1721460914,created_at:1721460914}),a.value=!1}};return f(()=>c(t)),{loading:a,dataset:e,loadDataset:c}},C=t=>{const a=w(),e=l(!1),c=g([]),s={current_page:1,page_size:20,total_page:0,total_record:0},n=g({...s}),i=async(o=!1)=>{var p,u,y;if(!(!o&&n.current_page>n.total_page))try{e.value=!0;const b=(await L(t,{current_page:((p=a.query)==null?void 0:p.current_page)||1,page_size:((u=a.query)==null?void 0:u.page_size)||20,search_word:((y=a.query)==null?void 0:y.search_word)||""})).data;r(b),c.splice(0,c.length,...b.list)}finally{c.push({id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",name:"LLMOps项目提示词",character_count:4700,hit_count:0,position:21,enabled:!0,disabled_at:0,status:"completed",error:"",updated_at:1726949586,created_at:1726949586},{id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",name:"embedding提示",character_count:2310,hit_count:0,position:11,enabled:!1,disabled_at:0,status:"completed",error:"",updated_at:1726949586,created_at:1726949586}),Object.assign(n,{current_page:1,page_size:20,total_page:1,total_record:2}),e.value=!1}},d=()=>{Object.assign(n,{...s})},r=o=>{n.current_page=o.paginator.current_page,n.page_size=o.paginator.page_size,n.total_page=o.paginator.total_page,n.total_record=o.paginator.total_record};return f(async()=>{await i(!0)}),D(()=>a.query,async(o,p)=>{o.search_word!==p.search_word?(d(),await i(!0)):o.current_page!==p.current_page&&await i()}),{loading:e,documents:c,paginator:n,loadDocuments:i}};export{$ as a,W as b,G as c,C as d,q as g,U as u};
