import{d as V,b as D,o as y,f as $,g as t,h as o,w as a,v as R,u as i,c as q,a as x,i as U,G as M,H as N,x as h,r,I as T,j as G}from"./index-C-t-NZBz.js";import{e as P,f as O,g as H,h as E,i as F}from"./use-app-ChZViiws.js";const I={class:"flex flex-col h-full"},J={class:"flex items-center justify-between px-4 mb-4"},K={class:"flex flex-col"},L={key:0,class:"mb-4 flex flex-col"},Q={class:"max-h-[321px] overflow-scroll scrollbar-w-none mb-2 text-gray-700 whitespace-pre-line"},W={class:""},X={class:"h-[50px] flex items-center gap-2 px-4 flex-1 border border-gray-200 rounded-full"},Y={class:"flex-1"},Z=V({__name:"PresetPromptTextarea",props:{app_id:{type:String,required:!0},preset_prompt:{type:String,required:!0}},emits:["update:preset_prompt"],setup(w,{emit:p}){const n=w,b=p,d=D(!1),u=D(""),{handleUpdateDraftAppConfig:l}=P(),{loading:_,optimize_prompt:m,handleOptimizePrompt:e}=O(),k=()=>{if(m.value.trim()===""){h.warning("优化prompt为空，请重新生成");return}b("update:preset_prompt",m.value),l(n.app_id,{preset_prompt:m.value}),d.value=!1},f=async()=>{if(u.value.trim()===""){h.warning("原始prompt不能为空");return}await e(m.value)};return(S,s)=>{const z=r("icon-sync"),v=r("a-button"),C=r("a-space"),c=r("icon-send"),j=r("a-card"),A=r("a-trigger"),B=r("a-textarea");return y(),$("div",I,[t("div",J,[s[8]||(s[8]=t("div",{class:"text-gray-700 font-bold"},"人设与回复逻辑",-1)),o(A,{"popup-visible":d.value,"onUpdate:popupVisible":s[2]||(s[2]=g=>d.value=g),trigger:["click"],position:"bl","popup-translate":[0,8]},{content:a(()=>[o(j,{class:"rounded-lg w-[422px]"},{default:a(()=>[t("div",K,[u.value?(y(),$("div",L,[t("div",Q,R(i(m)),1),i(_)?U("",!0):(y(),q(C,{key:0},{default:a(()=>[o(v,{size:"small",type:"primary",class:"rounded-lg",onClick:k},{default:a(()=>s[6]||(s[6]=[x(" 替换 ")])),_:1}),o(v,{size:"small",class:"rounded-lg",onClick:s[0]||(s[0]=g=>d.value=!1)},{default:a(()=>s[7]||(s[7]=[x("退出")])),_:1})]),_:1}))])):U("",!0),t("div",W,[t("div",X,[M(t("input",{"onUpdate:modelValue":s[1]||(s[1]=g=>u.value=g),type:"text",class:"flex-1 outline-0",placeholder:"你希望如何编写或优化提示词"},null,512),[[N,u.value]]),o(v,{loading:i(_),type:"text",shape:"circle",onClick:f},{icon:a(()=>[o(c,{size:16,class:"!text-blue-700"})]),_:1},8,["loading"])])])])]),_:1})]),default:a(()=>[o(v,{size:"mini",class:"rounded-lg px-2"},{icon:a(()=>[o(z)]),default:a(()=>[s[5]||(s[5]=x(" 优化 "))]),_:1})]),_:1},8,["popup-visible"])]),t("div",Y,[o(B,{class:"h-full resize-none !bg-transparent !border-0 text-gray-700 px-1",placeholder:"请在这里输入Agent的人设与回复逻辑(预设prompt)","max-length":2e3,"show-word-limit":"","model-value":n.preset_prompt,"onUpdate:modelValue":s[3]||(s[3]=g=>b("update:preset_prompt",g)),onBlur:s[4]||(s[4]=async()=>{await i(l)(n.app_id,{preset_prompt:n.preset_prompt})})},null,8,["model-value"])])])}}}),ee={class:""},te={class:"flex items-center justify-between border-b h-[64px] px-4"},se={class:"flex items-center justify-between"},oe={class:"pt-6"},le={class:"flex items-center justify-between"},ae=V({__name:"PreViewDebugHeader",props:{app_id:{type:String,required:!0},long_term_memory:{type:Object,required:!0}},setup(w){const p=w,{debug_conversation_summary:n,loadDebugConversationSummary:b}=H(),{loading:d,handleUpdateDebugConversationSummary:u}=E(),l=D(!1),_=async()=>{await b(p.app_id),l.value=!0};return(m,e)=>{var C;const k=r("icon-save"),f=r("a-button"),S=r("icon-close"),s=r("a-textarea"),z=r("a-space"),v=r("a-modal");return y(),$("div",ee,[t("div",te,[e[6]||(e[6]=t("div",{class:"text-lg text-gray-700"},"预览与调试",-1)),o(f,{disabled:!((C=p.long_term_memory)!=null&&C.enable),size:"mini",type:"text",class:"rounded-lg px-1 !text-blue-700",onClick:_},{icon:a(()=>[o(k)]),default:a(()=>[e[5]||(e[5]=x(" 长期记忆 "))]),_:1},8,["disabled"])]),o(v,{width:520,visible:l.value,"onUpdate:visible":e[4]||(e[4]=c=>l.value=c),"hide-title":"",footer:!1,"modal-class":"rounded-xl"},{default:a(()=>[t("div",se,[e[7]||(e[7]=t("div",{class:"text-lg font-bold text-gray-700"},"长期记忆",-1)),o(f,{type:"text",class:"!text-gray-700",size:"small",onClick:e[0]||(e[0]=c=>l.value=!1)},{icon:a(()=>[o(S)]),_:1})]),t("div",oe,[o(s,{"model-value":i(n),"onUpdate:modelValue":e[1]||(e[1]=c=>T(n)?n.value=c:null),placeholder:"请输入当前调试会话长期记忆","show-word-limit":"","max-length":2e3,"auto-size":{minRows:8,maxRows:8}},null,8,["model-value"]),t("div",le,[e[10]||(e[10]=t("div",{class:""},null,-1)),o(z,{size:16},{default:a(()=>[o(f,{class:"rounded-lg",onClick:e[2]||(e[2]=c=>l.value=!1)},{default:a(()=>e[8]||(e[8]=[x("取消")])),_:1}),o(f,{loading:i(d),type:"primary",class:"rounded-lg",onClick:e[3]||(e[3]=async()=>{await i(u)(p.app_id,i(n)),l.value=!1})},{default:a(()=>e[9]||(e[9]=[x(" 保存 ")])),_:1},8,["loading"])]),_:1})])])]),_:1},8,["visible"])])}}}),ne={class:"flex-1 w-full min-h-0 bg-white"},re={class:"flex-1 grid grid-cols-[26fr_14fr] h-full w-full"},ie={class:"bg-gray-50 flex flex-col h-full"},pe={class:"grid grid-cols-[13fr_13fr] overflow-hidden h-[calc(100vh-141px)]"},de={class:"border-r py-4"},me={class:"min-w-[404px]"},ce=V({__name:"DetailView",setup(w){var d;const p=G(),{draftAppConfigForm:n,loadDraftAppConfig:b}=F((d=p.params)==null?void 0:d.app_id);return P(),(u,l)=>{var _,m;return y(),$("div",ne,[t("div",re,[t("div",ie,[l[2]||(l[2]=t("div",{class:"flex items-center h-16 border-b p-4"},[t("div",{class:"text-lg text-gray-700"},"应用编排")],-1)),t("div",pe,[t("div",de,[o(Z,{preset_prompt:i(n).preset_prompt,"onUpdate:preset_prompt":l[0]||(l[0]=e=>i(n).preset_prompt=e),app_id:(_=i(p).params)==null?void 0:_.app_id},null,8,["preset_prompt","app_id"])]),l[1]||(l[1]=t("div",{class:""},"右侧应用能力",-1))])]),t("div",me,[o(ae,{app_id:(m=i(p).params)==null?void 0:m.app_id,long_term_memory:i(n).long_term_memory},null,8,["app_id","long_term_memory"])])])])}}});export{ce as default};
