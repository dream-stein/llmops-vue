import{k as D,r as l,p as g,q as m,h as b,v as _,M as v}from"./index-T-crqSHV.js";import{g as h,p as f}from"./request-RJC2F4Zf.js";const O=(t=1,a=10,e="")=>h("/datasets",{params:{current_page:t,page_size:a,search_word:e}}),z=t=>f("/datasets",{body:t}),M=(t,a)=>f(`/datasets/${t}`,{body:a}),P=t=>f(`/datasets/${t}/delete`),q=t=>h(`/datasets/${t}`),L=(t,a={current_page:1,page_size:20,search_word:""})=>h(`/datasets/${t}/documents`,{params:a}),S=(t,a)=>f(`/datasets/${t}/documents/${a}`),U=()=>{const t=D(),a=l(!1),e=g([]),r={current_page:1,page_size:20,total_page:0,total_record:0},s=g({...r}),c=async(n=!1)=>{var o;if(n)i();else if(s.current_page>s.total_page)return;try{a.value=!0;const p=(await O(s.current_page,s.page_size,String(((o=t.query)==null?void 0:o.search_word)??""))).data;d(p),s.current_page<=s.total_page&&(s.current_page+=1),n?e.splice(0,e.length,...p.list):e.push(...p.list)}finally{Object.assign(e,[{id:"46db30d1-3199-4e79-a0cd-abf12fa6858f",name:"慕课LLMOps知识库",icon:"https://cdn.imooc.com/dataset.png",description:"JavaScript是一种高级编程语言，用于创建交互式网页和动态效果，JavaScript在前端开发中扮演着非常重要的角色，因此学习 JavaScript 对于初级前端工程师来说非常必要。JavaScrip...",document_count:10,character_count:14651,related_app_count:2,updated_at:1721460914,created_at:1721460914}]),a.value=!1}},i=()=>{Object.assign(s,{...r})},d=n=>{s.current_page=n.current_page,s.page_size=n.page_size,s.total_page=n.total_page,s.total_record=n.total_record};return m(async()=>{await c(!0)}),b(()=>{var n;return(n=t.query)==null?void 0:n.search_word},async()=>{await c(!0)}),{loading:a,datasets:e,paginator:s,loadDatasets:c}},W=()=>({handleDelete:(a,e)=>{v.warning({title:"要删除知识库吗?",content:"删除知识库后，关联该知识库的应用将无法再使用该知识库，所有的提示配置和文档都将被永久删除",hideCancel:!1,onOk:async()=>{try{const r=await P(a);_.success(r.message)}finally{e&&e()}}})}}),C=()=>{const t=l(!1),e=g({...{fileList:[],icon:"",name:"",description:""}}),r=l(),s=l(!1);return{loading:t,form:e,formRef:r,saveDataset:async d=>{try{if(t.value=!0,d!==void 0&&d!==""){const n=await M(d,{icon:e.icon,name:e.name,description:e.description});_.success(n.message)}else{const n=await z({icon:e.icon,name:e.name,description:e.description});_.success(n.message)}}finally{t.value=!1}},showUpdateModal:s,updateShowUpdateModal:(d,n)=>{s.value=d,n&&n()}}},G=t=>{const a=l(!1),e=g({}),r=async s=>{try{a.value=!0;const i=(await q(s)).data;Object.assign(e,{...i})}finally{Object.assign(e,{id:"46db30d1-3199-4e79-a0cd-abf12fa6858f",name:"慕课LLMOps知识库",icon:"https://cdn.imooc.com/dataset.png",description:"",document_count:10,character_count:14651,hit_count:10,related_app_count:2,updated_at:1721460914,created_at:1721460914}),a.value=!1}};return m(()=>r(t)),{loading:a,dataset:e,loadDataset:r}},F=t=>{const a=D(),e=l(!1),r=g([]),s={current_page:1,page_size:20,total_page:0,total_record:0},c=g({...s}),i=async(o=!1)=>{var u,p,y;if(!(!o&&c.current_page>c.total_page))try{e.value=!0;const w=(await L(t,{current_page:((u=a.query)==null?void 0:u.current_page)||1,page_size:((p=a.query)==null?void 0:p.page_size)||20,search_word:((y=a.query)==null?void 0:y.search_word)||""})).data;n(w),r.splice(0,r.length,...w.list)}finally{r.push({id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",name:"LLMOps项目提示词",character_count:4700,hit_count:0,position:21,enabled:!0,disabled_at:0,status:"completed",error:"",updated_at:1726949586,created_at:1726949586},{id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",name:"embedding提示",character_count:2310,hit_count:0,position:11,enabled:!1,disabled_at:0,status:"completed",error:"",updated_at:1726949586,created_at:1726949586}),Object.assign(c,{current_page:1,page_size:20,total_page:1,total_record:2}),e.value=!1}},d=()=>{Object.assign(c,{...s})},n=o=>{c.current_page=o.paginator.current_page,c.page_size=o.paginator.page_size,c.total_page=o.paginator.total_page,c.total_record=o.paginator.total_record};return m(async()=>{await i(!0)}),b(()=>a.query,async(o,u)=>{o.search_word!==u.search_word?(d(),await i(!0)):o.current_page!==u.current_page&&await i()}),{loading:e,documents:r,paginator:c,loadDocuments:i}},R=()=>({handleDelete:(a,e,r)=>{v.warning({title:"要删除该文档吗?",content:"删除文档后，数据库/向量数据库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁言功能",hideCancel:!1,onOk:async()=>{try{const s=await S(a,e);_.success(s.message)}finally{r&&r()}}})}});export{C as a,W as b,G as c,F as d,R as e,q as g,U as u};
