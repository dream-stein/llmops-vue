import{k as b,r as l,p as g,q as h,h as w,v as f,M as v}from"./index-Ci0pjunh.js";import{g as m,p as _}from"./request-2K9xL87o.js";const O=(t=1,a=10,e="")=>m("/datasets",{params:{current_page:t,page_size:a,search_word:e}}),$=t=>_("/datasets",{body:t}),z=(t,a)=>_(`/datasets/${t}`,{body:a}),M=t=>_(`/datasets/${t}/delete`),P=t=>m(`/datasets/${t}`),q=(t,a={current_page:1,page_size:20,search_word:""})=>m(`/datasets/${t}/documents`,{params:a}),W=(t,a)=>m(`/datasets/${t}/documents/${a}`),L=(t,a,e)=>_(`/datasets/${t}/documents/${a}/enabled`,{body:{enabled:e}}),S=(t,a)=>_(`/datasets/${t}/documents/${a}`),C=(t,a,e)=>_(`/datasets/${t}/documents/${a}`,{body:{name:e}}),G=()=>{const t=b(),a=l(!1),e=g([]),n={current_page:1,page_size:20,total_page:0,total_record:0},s=g({...n}),c=async(r=!1)=>{var o;if(r)d();else if(s.current_page>s.total_page)return;try{a.value=!0;const p=(await O(s.current_page,s.page_size,String(((o=t.query)==null?void 0:o.search_word)??""))).data;i(p),s.current_page<=s.total_page&&(s.current_page+=1),r?e.splice(0,e.length,...p.list):e.push(...p.list)}finally{Object.assign(e,[{id:"46db30d1-3199-4e79-a0cd-abf12fa6858f",name:"慕课LLMOps知识库",icon:"https://cdn.imooc.com/dataset.png",description:"JavaScript是一种高级编程语言，用于创建交互式网页和动态效果，JavaScript在前端开发中扮演着非常重要的角色，因此学习 JavaScript 对于初级前端工程师来说非常必要。JavaScrip...",document_count:10,character_count:14651,related_app_count:2,updated_at:1721460914,created_at:1721460914}]),a.value=!1}},d=()=>{Object.assign(s,{...n})},i=r=>{s.current_page=r.current_page,s.page_size=r.page_size,s.total_page=r.total_page,s.total_record=r.total_record};return h(async()=>{await c(!0)}),w(()=>{var r;return(r=t.query)==null?void 0:r.search_word},async()=>{await c(!0)}),{loading:a,datasets:e,paginator:s,loadDatasets:c}},E=()=>({handleDelete:(a,e)=>{v.warning({title:"要删除知识库吗?",content:"删除知识库后，关联该知识库的应用将无法再使用该知识库，所有的提示配置和文档都将被永久删除",hideCancel:!1,onOk:async()=>{try{const n=await M(a);f.success(n.message)}finally{e&&e()}}})}}),F=()=>{const t=l(!1),e=g({...{fileList:[],icon:"",name:"",description:""}}),n=l(),s=l(!1);return{loading:t,form:e,formRef:n,saveDataset:async i=>{try{if(t.value=!0,i!==void 0&&i!==""){const r=await z(i,{icon:e.icon,name:e.name,description:e.description});f.success(r.message)}else{const r=await $({icon:e.icon,name:e.name,description:e.description});f.success(r.message)}}finally{t.value=!1}},showUpdateModal:s,updateShowUpdateModal:(i,r)=>{s.value=i,r&&r()}}},R=t=>{const a=l(!1),e=g({}),n=async s=>{try{a.value=!0;const d=(await P(s)).data;Object.assign(e,{...d})}finally{Object.assign(e,{id:"46db30d1-3199-4e79-a0cd-abf12fa6858f",name:"慕课LLMOps知识库",icon:"https://cdn.imooc.com/dataset.png",description:"",document_count:10,character_count:14651,hit_count:10,related_app_count:2,updated_at:1721460914,created_at:1721460914}),a.value=!1}};return h(()=>n(t)),{loading:a,dataset:e,loadDataset:n}},x=t=>{const a=b(),e=l(!1),n=g([]),s={current_page:1,page_size:20,total_page:0,total_record:0},c=g({...s}),d=async(o=!1)=>{var u,p,y;if(!(!o&&c.current_page>c.total_page))try{e.value=!0;const D=(await q(t,{current_page:((u=a.query)==null?void 0:u.current_page)||1,page_size:((p=a.query)==null?void 0:p.page_size)||20,search_word:((y=a.query)==null?void 0:y.search_word)||""})).data;r(D),n.splice(0,n.length,...D.list)}finally{n.push({id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",name:"LLMOps项目提示词",character_count:4700,hit_count:0,position:21,enabled:!0,disabled_at:0,status:"completed",error:"",updated_at:1726949586,created_at:1726949586},{id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",name:"embedding提示",character_count:2310,hit_count:0,position:11,enabled:!1,disabled_at:0,status:"error",error:"",updated_at:1726949586,created_at:1726949586}),Object.assign(c,{current_page:1,page_size:20,total_page:1,total_record:2}),e.value=!1}},i=()=>{Object.assign(c,{...s})},r=o=>{c.current_page=o.paginator.current_page,c.page_size=o.paginator.page_size,c.total_page=o.paginator.total_page,c.total_record=o.paginator.total_record};return h(async()=>{await d(!0)}),w(()=>a.query,async(o,u)=>{o.search_word!==u.search_word?(i(),await d(!0)):o.current_page!==u.current_page&&await d()}),{loading:e,documents:n,paginator:c,loadDocuments:d}},N=()=>({handleDelete:(a,e,n)=>{v.warning({title:"要删除该文档吗?",content:"删除文档后，数据库/向量数据库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁言功能",hideCancel:!1,onOk:async()=>{try{const s=await S(a,e);f.success(s.message)}finally{n&&n()}}})}}),A=()=>({handleUpdate:async(a,e,n,s)=>{try{const c=await L(a,e,n);f.success(c.message)}finally{s&&s()}}});export{F as a,E as b,C as c,W as d,R as e,x as f,P as g,N as h,A as i,G as u};
