import{A as m,r as p,E as d,o as y,y as h,M as _,L as w}from"./index-Al_Fbm-V.js";import{j as D,k as P,l as v,g as z,m as S,a as U,n as q,o as O,p as j,q as M,r as A,s as W}from"./dataset-B8vkSiK4.js";const k=()=>{const i=m(),s=p(!1),a=d([]),t={current_page:1,page_size:20,total_page:0,total_record:0},e=d({...t}),r=async(o=!1)=>{var c;if(o)n();else if(e.current_page>e.total_page)return;try{s.value=!0;const g=(await D(e.current_page,e.page_size,String(((c=i.query)==null?void 0:c.search_word)??""))).data;l(g),e.current_page<=e.total_page&&(e.current_page+=1),o?a.splice(0,a.length,...g.list):a.push(...g.list)}finally{s.value=!1}},n=()=>{Object.assign(e,{...t})},l=o=>{e.current_page=o.current_page,e.page_size=o.page_size,e.total_page=o.total_page,e.total_record=o.total_record};return y(async()=>{await r(!0)}),h(()=>{var o;return(o=i.query)==null?void 0:o.search_word},async()=>{await r(!0)}),{loading:s,datasets:a,paginator:e,loadDatasets:r}},F=()=>({handleDelete:(s,a)=>{w.warning({title:"要删除知识库吗?",content:"删除知识库后，关联该知识库的应用将无法再使用该知识库，所有的提示配置和文档都将被永久删除",hideCancel:!1,onOk:async()=>{try{const t=await O(s);_.success(t.message)}finally{a&&a()}}})}}),L=()=>{const i=p(!1),a=d({...{fileList:[],icon:"",name:"",description:""}}),t=p(),e=p(!1);return{loading:i,form:a,formRef:t,saveDataset:async l=>{try{if(i.value=!0,l!==void 0&&l!==""){const o=await P(l,{icon:a.icon,name:a.name,description:a.description});_.success(o.message)}else{const o=await v({icon:a.icon,name:a.name,description:a.description});_.success(o.message)}}finally{i.value=!1}},showUpdateModal:e,updateShowUpdateModal:(l,o)=>{e.value=l,o&&o()}}},R=i=>{const s=p(!1),a=d({}),t=async e=>{try{s.value=!0;const n=(await z(e)).data;Object.assign(a,{...n})}finally{s.value=!1}};return y(()=>t(i)),{loading:s,dataset:a,loadDataset:t}},x=i=>{const s=m(),a=p(!1),t=d([]),e={current_page:1,page_size:20,total_page:0,total_record:0},r=d({...e}),n=async(c=!1)=>{var u,g,f;if(!(!c&&r.current_page>r.total_page))try{a.value=!0;const b=(await S(i,{current_page:((u=s.query)==null?void 0:u.current_page)||1,page_size:((g=s.query)==null?void 0:g.page_size)||20,search_word:((f=s.query)==null?void 0:f.search_word)||""})).data;o(b),t.splice(0,t.length,...b.list)}finally{a.value=!1}},l=()=>{Object.assign(r,{...e})},o=c=>{r.current_page=c.paginator.current_page,r.page_size=c.paginator.page_size,r.total_page=c.paginator.total_page,r.total_record=c.paginator.total_record};return y(async()=>{await n(!0)}),h(()=>s.query,async(c,u)=>{c.search_word!==u.search_word?(l(),await n(!0)):c.current_page!==u.current_page&&await n()}),{loading:a,documents:t,paginator:r,loadDocuments:n}},B=()=>({handleDelete:(s,a,t)=>{w.warning({title:"要删除该文档吗?",content:"删除文档后，数据库/向量数据库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁言功能",hideCancel:!1,onOk:async()=>{try{const e=await j(s,a);_.success(e.message)}finally{t&&t()}}})}}),H=()=>({handleUpdate:async(s,a,t,e)=>{try{const r=await M(s,a,t);_.success(r.message)}finally{e&&e()}}}),I=(i,s)=>{const a=p(!1),t=d({}),e=async(r,n)=>{try{a.value=!0;const o=(await U(r,n)).data;Object.assign(t,{...o})}finally{a.value=!1}};return y(async()=>await e(i,s)),{loading:a,document:t,loadDocument:e}},J=(i,s)=>{const a=m(),t=p(!1),e=d([]),r={current_page:1,page_size:20,total_page:0,total_record:0},n=d({...r}),l=async(c=!1)=>{var u;if(c)Object.assign(n,{...r});else if(n.current_page>n.total_page)return;try{t.value=!0;const f=(await q(i,s,{current_page:n.current_page,page_size:n.page_size,search_word:String(((u=a.query)==null?void 0:u.search_word)||"")})).data;o(f),n.current_page<=n.total_page&&(n.current_page+=1),c?e.splice(0,e.length,...f.list):e.push(...f.list)}finally{e.push({id:"b7087193-8e1b-4e88-8ae4-48a0f90a8ad5",document_id:"6a266b4b-d03b-4066-a4bb-f64abfe23b9d",dataset_id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",position:12,content:"为了提倡社交产品的流量，让用户主动分享APP中的内容到社交平台来达到拉新和促活的目的，市场上的绝大多数APP都有第三发分享的功能，它是内容分发的最有效途径，并且大大降低了企...",keywords:["社交","App","成本","功能","内容分发"],character_count:487,token_count:407,hit_count:1,enabled:!0,disabled_at:0,status:"completed",error:"",updated_at:1726858854,created_at:1726858854},{id:"b7087193-8e1b-4e88-8ae4-48a0f90a8ad4",document_id:"6a266b4b-d03b-4066-a4bb-f64abfe23b9d",dataset_id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",position:1,content:"为了提倡社交产品的流量，让用户主动分享APP中的内容到社交平台来达到拉新和促活的目的，市场上的绝大多数APP都有第三发分享的功能，它是内容分发的最有效途径，并且大大降低了企...",keywords:["llm","内容分发"],character_count:487,token_count:407,hit_count:1,enabled:!1,disabled_at:0,status:"completed",error:"",updated_at:1726858854,created_at:1726858854}),t.value=!1}},o=c=>{n.current_page=c.paginator.current_page,n.page_size=c.paginator.page_size,n.total_page=c.paginator.total_page,n.total_record=c.paginator.total_record};return y(async()=>{await l(!0)}),h(()=>{var c;return(c=a.query)==null?void 0:c.search_word},async()=>{await l(!0)}),{loading:t,segments:e,paginator:n,loadSegments:l}},K=()=>({handleDelete:async(s,a,t,e)=>{w.warning({title:"要删除该文档片段吗？",content:"删除文档片段后，知识库/向量知识库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁用功能。",hideCancel:!1,onOk:async()=>{try{const r=await A(s,a,t);_.success(r.message)}finally{e&&e()}}})}}),N=()=>({handleUpdate:async(s,a,t,e,r)=>{try{const n=await W(s,a,t,e);_.success(n.message)}finally{r&&r()}}});export{L as a,F as b,R as c,x as d,B as e,H as f,I as g,J as h,K as i,N as j,k as u};
