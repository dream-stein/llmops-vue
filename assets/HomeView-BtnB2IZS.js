import{s as J,p as Q,g as R,r as d,M as H,d as X,u as Y,o as Z,n as ee,c as w,a as r,w as _,b as a,e as u,f as te,h as se,i as k,F as ne,j as ae,k as oe,v as le,l as ie,m as re,Q as q,q as h,t as C,x as ue}from"./index-C09ZU7FL.js";import{u as ce,s as ge,_ as de,a as ve,b as pe}from"./AiMessage.vue_vue_type_script_setup_true_lang-Dvcr-_xT.js";const fe=(s,l)=>J("/assistant-agent/chat",{body:{query:s}},l),_e=s=>Q(`/assistant-agent/chat/${s}/stop`),he=s=>R("/assistant-agent/messages",{params:s}),ye=()=>Q("/assistant-agent/delete-conversation"),xe=()=>{const s=d(!1);return{loading:s,handleAssistantAgentChat:async(i,c)=>{try{s.value=!0,await fe(i,c)}finally{s.value=!1}}}},Ae=()=>{const s=d(!1);return{loading:s,handleStopAssistantAgentChat:async i=>{try{s.value=!0,await _e(i)}finally{s.value=!1}}}},me=()=>{const s=d(!1),l=d([]),i=d(0),c={current_page:1,page_size:5,total_page:0,total_record:0},n=d({...c});return{loading:s,messages:l,paginator:n,loadAssistantAgentMessages:async(S=!1)=>{var M;if(S)n.value={...c},i.value=0;else if(n.value.current_page>n.value.total_page)return;try{s.value=!0;const y=(await he({current_page:n.value.current_page,page_size:n.value.page_size,created_at:i.value})).data;n.value=y.paginator,n.value.current_page<=n.value.total_page&&(n.value.current_page+=1),S?l.value=y.list:(l.value.push(...y.list),i.value=((M=y.list[0])==null?void 0:M.created_at)??0)}finally{s.value=!1}}}},be=()=>{const s=d(!1);return{loading:s,handleDeleteAssistantAgentConversation:async()=>{try{s.value=!0;const i=await ye();H.success(i.message)}finally{s.value=!1}}}},we="/llmops-vue/assets/assistant-agent-background-Jf_uHUnU.png",ke={class:"w-[600px] h-full min-h-screen mx-auto"},Ce={key:0,class:"flex flex-col px-6 h-[calc(100%-100px)] min-h-[calc(100vh-100px)]"},Se={class:"flex flex-col gap-6 py-6"},Me={key:0,class:"h-[50px] flex items-center justify-center"},Le={key:1,class:"flex flex-col p-6 gap-2 items-center justify-center overflow-scroll scrollbar-w-none h-[calc(100%-100px)] min-h-[calc(100vh-100px)]"},qe={class:"flex gap-2"},Te={class:"flex flex-col items-start gap-2"},ze={class:"bg-white border border-gray-200 text-gray-700 px-4 py-3 rounded-2xl break-all leading-7"},Ie={class:"list-disc pl-6"},$e={class:"flex flex-col gap-2"},Be=["onClick"],He={class:"w-full flex flex-col flex-shrink-0"},Qe={class:"px-6 flex items-center gap-4"},Ve={class:"bg-white h-[50px] flex items-center gap-2 px-4 flex-1 border border-gray-200 rounded-full"},Ne=X({__name:"HomeView",setup(s){const l=d(""),i=d(""),c=d(""),n=d(null),T=d(0),S=Y(),M=["ä»€ä¹ˆæ˜¯LLMOps?","æˆ‘æƒ³åˆ›å»ºä¸€ä¸ªåº”ç”¨","èƒ½ä»‹ç»ä¸‹ä»€ä¹ˆæ˜¯RAGå—?"],{suggested_questions:z,handleGenerateSuggestedQuestions:y}=ce(),{loading:m,handleAssistantAgentChat:P}=xe(),{loading:N,handleStopAssistantAgentChat:O}=Ae(),{loading:G,messages:g,loadAssistantAgentMessages:I}=me(),{loading:j,handleDeleteAssistantAgentConversation:U}=be(),W=()=>{T.value=n.value.$el.scrollHeight},E=()=>{n.value.$el.scrollTop=n.value.$el.scrollHeight-T.value},F=async v=>{const{scrollTop:t}=v.target;t<=0&&!G.value&&(W(),await I(!1),E())},$=async()=>{if(l.value.trim()===""){H.warning("ç”¨æˆ·æé—®ä¸èƒ½ä¸ºç©º");return}if(m.value){H.warning("ä¸Šä¸€æ¬¡æé—®è¿˜æœªç»“æŸï¼Œè¯·ç¨ç­‰");return}z.value=[],c.value="",i.value="",g.value.unshift({id:"",conversation_id:"",query:l.value,answer:"",total_token_count:0,latency:0,agent_thoughts:[],created_at:0});let v=0;const t=l.value;l.value="",await P(t,p=>{var L;const x=p==null?void 0:p.event,e=p==null?void 0:p.data,b=e==null?void 0:e.id,f=g.value[0].agent_thoughts;if(c.value===""&&(e!=null&&e.message_id)&&(i.value=e==null?void 0:e.task_id,c.value=e==null?void 0:e.message_id,g.value[0].id=e==null?void 0:e.message_id,g.value[0].conversation_id=e==null?void 0:e.conversation_id),x!==q.ping){if(x===q.agentMessage){const A=f.findIndex(o=>(o==null?void 0:o.id)===b);A===-1?(v+=1,f.push({id:b,position:v,event:e==null?void 0:e.event,thought:e==null?void 0:e.thought,observation:e==null?void 0:e.observation,tool:e==null?void 0:e.tool,tool_input:e==null?void 0:e.tool_input,latency:e==null?void 0:e.latency,created_at:0})):f[A]={...f[A],thought:((L=f[A])==null?void 0:L.thought)+(e==null?void 0:e.thought),latency:e==null?void 0:e.latency},g.value[0].answer+=e==null?void 0:e.thought,g.value[0].latency=e==null?void 0:e.latency,g.value[0].total_token_count=e==null?void 0:e.total_token_count}else x===q.error?g.value[0].answer=e==null?void 0:e.observation:x===q.timeout?g.value[0].answer="å½“å‰Agentæ‰§è¡Œå·²è¶…æ—¶ï¼Œæ— æ³•å¾—åˆ°ç­”æ¡ˆï¼Œè¯·é‡è¯•":(v+=1,f.push({id:b,position:v,event:e==null?void 0:e.event,thought:e==null?void 0:e.thought,observation:e==null?void 0:e.observation,tool:e==null?void 0:e.tool,tool_input:e==null?void 0:e.tool_input,latency:e==null?void 0:e.latency,created_at:0}));g.value[0].agent_thoughts=f,n.value.scrollToBottom()}}),c.value&&(await y(c.value),setTimeout(()=>n.value&&n.value.scrollToBottom(),100))},V=async()=>{i.value===""||!m.value||await O(i.value)},D=async v=>{l.value=v,await $()};Z(async()=>{await I(!0),await ee(()=>{n.value&&n.value.scrollToBottom()})});async function K(){const v=await Q("/apps/7a3e1f8d-4b6c-4a2d-9f1e-3c8a5b7d2e1f/debug",{body:{query:"ä½ å¥½ï¼Œ ä½ æ˜¯è°"}});console.log(v)}return(v,t)=>{const p=h("a-button"),x=h("icon-poweroff"),e=h("icon-apps"),b=h("a-avatar"),f=h("router-link"),L=h("icon-empty"),A=h("icon-send");return C(),w("div",{class:"w-full h-full min-h-screen bg-gray-100 bg-cover bg-no-repeat bg-center",style:re({backgroundImage:`url(${u(we)})`})},[r(p,{onClick:K},{default:_(()=>t[2]||(t[2]=[k("å‘èµ·è¯·æ±‚")])),_:1}),a("div",ke,[u(g).length>0?(C(),w("div",Ce,[r(u(pe),{ref_key:"scroller",ref:n,items:u(g).slice().reverse(),"min-item-size":1,onScroll:F,class:"h-full scrollbar-w-none"},{default:_(({item:o,active:B})=>[r(u(ge),{item:o,active:B,"data-index":o.id},{default:_(()=>[a("div",Se,[r(de,{query:o.query,account:u(S).account},null,8,["query","account"]),r(ve,{agent_thoughts:o.agent_thoughts,answer:o.answer,app:{name:"è¾…åŠ©Agent"},suggested_questions:o.id===c.value?u(z):[],loading:o.id===c.value&&u(m),latency:o.latency,total_token_count:o.total_token_count,message_class:"bg-white",onSelectSuggestedQuestion:D},null,8,["agent_thoughts","answer","suggested_questions","loading","latency","total_token_count"])])]),_:2},1032,["item","active","data-index"])]),_:1},8,["items"]),i.value&&u(m)?(C(),w("div",Me,[r(p,{loading:u(N),class:"rounded-lg px-2",onClick:V},{icon:_(()=>[r(x)]),default:_(()=>[t[3]||(t[3]=k(" åœæ­¢å“åº” "))]),_:1},8,["loading"])])):te("",!0)])):(C(),w("div",Le,[t[13]||(t[13]=se('<div class="mb-9"><div class="text-[40px] font-bold text-gray-700 mt-[52px] mb-4"> Hiï¼Œæˆ‘æ˜¯ AI åº”ç”¨æ„å»ºå™¨ </div><div class="text-[30px] font-bold text-gray-700 mb-2"> ä½ çš„ä¸“å± <span class="text-blue-700">AI åŸç”Ÿåº”ç”¨</span> å¼€å‘å¹³å° </div><div class="text-base text-gray-700"> è¯´å‡ºä½ çš„åˆ›æ„ï¼Œæˆ‘å¯ä»¥å¿«é€Ÿå¸®ä½ åˆ›å»ºä¸“å±åº”ç”¨ï¼Œä¸€é”®è½»æ¾åˆ†äº«ç»™æœ‹å‹ï¼Œä¹Ÿå¯ä»¥ä¸€é”®å‘å¸ƒåˆ° LLMOps å¹³å°ã€å¾®ä¿¡ç­‰å¤šä¸ªæ¸ é“ã€‚ </div></div>',1)),a("div",qe,[r(b,{size:30,shape:"circle",class:"flex-shrink-0 bg-blue-700"},{default:_(()=>[r(e)]),_:1}),a("div",Te,[t[12]||(t[12]=a("div",{class:"text-gray-700 font-bold"},"è¾…åŠ©Agent",-1)),a("div",ze,[t[9]||(t[9]=a("div",{class:"font-bold"},"ä½ å¥½ï¼Œæ¬¢è¿æ¥åˆ°LLMOpsğŸ‰",-1)),t[10]||(t[10]=a("div",{class:""}," LLMOpsæ˜¯æ–°ä¸€ä»£å¤§æ¨¡å‹ AI åº”ç”¨å¼€å‘å¹³å°ã€‚æ— è®ºä½ æ˜¯å¦æœ‰ç¼–ç¨‹åŸºç¡€ï¼Œéƒ½å¯ä»¥å¿«é€Ÿæ­å»ºå‡ºå„ç§ AI åº”ç”¨ï¼Œå¹¶ä¸€é”®å‘å¸ƒåˆ°å„å¤§ç¤¾äº¤å¹³å°ï¼Œæˆ–è€…è½»æ¾éƒ¨ç½²åˆ°è‡ªå·±çš„ç½‘ç«™ã€‚ ",-1)),a("ul",Ie,[a("li",null,[t[5]||(t[5]=k(" éšæ—¶æ¥ ")),r(f,{to:{name:"store-apps-list"},class:"text-blue-700"},{default:_(()=>t[4]||(t[4]=[k("åº”ç”¨å¹¿åœº ")])),_:1}),t[6]||(t[6]=k(" é€›é€›ï¼Œè¿™é‡Œå†…ç½®äº†è®¸å¤šè¶…æœ‰è¶£çš„åº”ç”¨ã€‚ "))]),t[7]||(t[7]=a("li",null,"ä½ ä¹Ÿå¯ä»¥ç›´æ¥å‘é€â€œæˆ‘æƒ³åšä¸€ä¸ªåº”ç”¨â€ï¼Œæˆ‘å¯ä»¥å¸®ä½ å¿«é€Ÿåˆ›å»ºåº”ç”¨ã€‚",-1)),t[8]||(t[8]=a("li",null,"ä½ ä¹Ÿå¯ä»¥å‘æˆ‘æé—®æœ‰å…³è¯¾ç¨‹çš„é—®é¢˜ï¼Œæˆ‘å¯ä»¥å¿«é€Ÿæ›¿ä½ è§£ç­”ã€‚",-1))]),t[11]||(t[11]=a("div",{class:""},"å¦‚æœä½ è¿˜æœ‰å…¶ä»–LLMOpsä½¿ç”¨é—®é¢˜ï¼Œä¹Ÿæ¬¢è¿éšæ—¶é—®æˆ‘ï¼",-1))]),a("div",$e,[(C(),w(ne,null,ae(M,(o,B)=>a("div",{key:B,class:"px-4 py-1.5 border rounded-lg text-gray-700 cursor-pointer bg-white hover:bg-gray-50",onClick:async()=>await D(o)},ue(o),9,Be)),64))])])])])),a("div",He,[a("div",Qe,[r(p,{loading:u(j),class:"flex-shrink-0 !text-gray-700",type:"text",shape:"circle",onClick:t[0]||(t[0]=async()=>{await V(),await u(U)(),await u(I)(!0)})},{icon:_(()=>[r(L,{size:16})]),_:1},8,["loading"]),a("div",Ve,[oe(a("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>l.value=o),type:"text",class:"flex-1 outline-0",placeholder:"å‘é€æ¶ˆæ¯æˆ–åˆ›å»ºAIåº”ç”¨...",onKeyup:ie($,["enter"])},null,544),[[le,l.value]]),r(p,{loading:u(m),type:"text",shape:"circle",class:"!text-gray-700",onClick:$},{icon:_(()=>[r(A,{size:16})]),_:1},8,["loading"])])]),t[14]||(t[14]=a("div",{class:"text-center text-gray-500 text-xs py-4"}," å†…å®¹ç”±AIç”Ÿæˆï¼Œæ— æ³•ç¡®ä¿çœŸå®å‡†ç¡®ï¼Œä»…ä¾›å‚è€ƒã€‚ ",-1))])])],4)}}});export{Ne as default};
