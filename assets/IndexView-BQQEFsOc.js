import{g as ve,s as Ze,p as le,r as p,M as Q,P as et,d as Oe,y as Fe,z as ee,w as i,q as _,t as b,b as u,a,i as M,e as d,u as tt,E as pe,o as at,I as nt,c as w,x as O,F as Z,j as oe,f as B,J as H,k as ot,v as st,l as lt,A as it,Q as se,C as ct,n as rt}from"./index-C3nWTMc_.js";import{u as ut,s as dt,_ as pt,a as vt,b as _t}from"./AiMessage.vue_vue_type_script_setup_true_lang-DG8cGbXA.js";import{l as gt}from"./lodash-C9Xh3bLA.js";const ft=n=>ve(`/web-apps/${n}`),mt=(n,s,r)=>Ze(`/web-apps/${n}/chat`,{body:s},r),ht=(n,s)=>le(`/web-apps/${n}/chat/${s}/stop`),Ue=(n,s=!1)=>ve(`/web-apps/${n}/conversations`,{params:{is_pinned:s}}),bt=()=>{const n=p(!1),s=p({});return{loading:n,web_app:s,loadWebApp:async g=>{try{n.value=!0;const c=await ft(g);s.value=c.data}finally{n.value=!1}}}},yt=()=>{const n=p(!1);return{loading:n,handleWebAppChat:async(r,g,c)=>{try{n.value=!0,await mt(r,g,c)}finally{n.value=!1}}}},xt=()=>{const n=p(!1);return{loading:n,handleStopWebAppChat:async(r,g)=>{try{n.value=!0,await ht(r,g)}finally{n.value=!1}}}},wt=()=>{const n=p(!1),s=p([]),r=p([]);return{loading:n,pinned_conversations:s,unpinned_conversations:r,loadWebAppConversations:async c=>{try{n.value=!0;const[m,C]=await Promise.all([Ue(c,!0),Ue(c,!1)]);s.value=m.data,r.value=C.data}finally{s.value=[{id:"2d7d3e3f-95c9-4d9d-ba9c-9daaf09cc8a8",name:"用户咨询什么是LLM?",summary:"",created_at:1714053834},{id:"2d7d3e3f-95c9-4d9d-ba9c-9daaf09cc8a7",name:"用户咨询什么是LLM2?",summary:"",created_at:1714053835}],r.value=[{id:"2d7d3e1f-95c9-4d9d-ba9c-9daaf09cc9a8",name:"你好?",summary:"",created_at:1714053834},{id:"2d7d3e2f-95c9-4d9d-ba9c-9daaf09cc7a7",name:"what?",summary:"",created_at:1714053835}],n.value=!1}}}},kt=(n,s)=>ve(`/conversations/${n}/messages`,{params:s}),Ct=n=>le(`/conversations/${n}/delete`),At=(n,s)=>le(`/conversations/${n}/name`,{body:{name:s}}),Lt=(n,s)=>le(`/conversations/${n}/is-pinned`,{body:{is_pinned:s}}),It=()=>{const n=p(!1),s=p([]),r=p(0),g={current_page:1,page_size:5,total_page:0,total_record:0},c=p({...g});return{loading:n,messages:s,paginator:c,loadConversationMessagesWithPage:async(C,h=!1)=>{var U;if(h)c.value={...g},r.value=0;else if(c.value.current_page>c.value.total_page)return;try{n.value=!0;const k=(await kt(C,{current_page:c.value.current_page,page_size:c.value.page_size,created_at:r.value})).data;c.value=k.paginator,c.value.current_page<=c.value.total_page&&(c.value.current_page+=1),h?s.value=k.list:(s.value.push(...k.list),r.value=((U=k.list[0])==null?void 0:U.created_at)??0)}finally{s.value=[{agent_thoughts:[{created_at:1736800082,event:"long_term_memory_recall",id:"66ef482b-7fec-4375-8016-e758e117840e",latency:0,observation:"人类询问AI关于LLMops的情况，AI解释道LLMOps（大型语言模型操作）是管理和优化大型语言模型生命周期的一系列实践和技术，涵盖模型训练、部署、监控、维护和持续改进等方面，并表示愿意提供更多具体信息。",position:1,thought:"",tool:"",tool_input:{}},{created_at:1736800082,event:"agent_thought",id:"edb30bb1-f1e1-49eb-bbdf-de77b432dc12",latency:1.8113511000046856,observation:"",position:2,thought:'[{"name": "google_serper", "args": {"query": "未来人类自我意识的发展趋势"}, "id": "chatcmpl-Y6XafuEwiz2ltddFCGmcyVsMzOSvk", "type": "tool_call"}]',tool:"",tool_input:{}},{created_at:1736800082,event:"agent_action",id:"8eedbf60-776a-4bb4-87cf-a00054b3dcf3",latency:1.3353191999995033,observation:'"... 人类的感知和思考能力。 当然，这远远不足以让人工智能产生真正的自我意识，但这是未来的趋势。 其次，自我意识是一个非常复杂的概念，涉及到许多不同 ... ... ➤大模型、大数据的驱动让人工智能在对话的自然度、趣味性上有了很大突破，但距离具备自主意识还很远。换言之，即便人工智能可以对人类的语言、表情 ... 人类未来的新角色是智能机器的“牧羊人”，人最重要的能力将是使用 ... 所以与意识相关的自主决策、自我管理、自我纠正、自我提升，这些研究已然 ... ... 未来可能会有越来越多的人工智能被设计出来辅助人类推进社会管理工作。对自我反思能力的探讨，或许会对未来人工智能的良性发展有所助益。 3.高尚人格 ... 如果AI拥有自我意识是朝着好的方向发展，就不可怕。其实不管未来是什么样的情况，谁也无法定论，只能是列出尽可能多的情况供大家参考，这本身也是有意义的。 实验结果表明，当前以大模型为代表的AI已接近人类成人智能水平，但尚无证据表明其具备自我意识。 此外，研究还揭示了实现具有自我意识的通用人工智能（AGI）在 ... 当今的人工智能发展突飞猛进，人们对其远超于人的强劲的能力抱有警惕甚至恐惧的态度。人工智. 能一旦具有了“自我意识”，其存在对人类来说将可能会是毁灭性的 ... 机器能有自我意识吗？随着自主人工智能(AI)的发展,这些系统是否能够真正实现自我意识的问题变得更加重要。技术已经取得了长足的进步，但要制造出像人类一样 ... 摩尔定律& 莫拉维克悖论尽管每个人都相信人有意识和自我意识，但是机器究竟有没有自我意识，能不能以及何时会发展出自我意识，是我们知之甚少也知之不确 ... 本专题的四篇文章分别从自我意识、算法安全、. 算法歧视和外观设计四个方向探索了人工智能的前景。 ... 类理智的高阶部分，而意识和自我意识属于人类. 的本能活动，是不 ..."',position:3,thought:"",tool:"google_serper",tool_input:{query:"未来人类自我意识的发展趋势"}},{created_at:1736800082,event:"agent_message",id:"61571260-c7a0-40cf-9c9f-c135b8eb1a7e",latency:2.6854701999982353,observation:"",position:4,thought:`未来人类自我意识的发展可能会受到人工智能（AI）和技术进步的深刻影响。虽然当前AI尚未具备真正的自我意识，但随着技术的不断演进，未来可能会出现更为复杂的智能系统，这些系统可能会在某种程度上模拟人类的自我意识。

研究表明，人类的自我意识是一个复杂而动态的概念，涉及多种心理和生物因素。未来的AI可能会在某些方面超越人类的认知能力，但是否能真正拥有自我意识仍然存在争议。

此外，随着社会对AI伦理和安全性的关注加剧，如何管理和规范这些技术的发展也将成为重要议题。总之，未来人类自我意识的发展将是一个充满挑战和机遇的领域。`,tool:"",tool_input:{}}],answer:`未来人类自我意识的发展可能会受到人工智能（AI）和技术进步的深刻影响。虽然当前AI尚未具备真正的自我意识，但随着技术的不断演进，未来可能会出现更为复杂的智能系统，这些系统可能会在某种程度上模拟人类的自我意识。

研究表明，人类的自我意识是一个复杂而动态的概念，涉及多种心理和生物因素。未来的AI可能会在某些方面超越人类的认知能力，但是否能真正拥有自我意识仍然存在争议。

此外，随着社会对AI伦理和安全性的关注加剧，如何管理和规范这些技术的发展也将成为重要议题。总之，未来人类自我意识的发展将是一个充满挑战和机遇的领域。`,conversation_id:"73f1d3f4-9388-48a4-a49a-46acf090f653",created_at:1736800076,id:"2d14d0ea-5b23-4e50-ad52-976d228e4a1d",latency:5.832140500002424,query:"人类自我意识的未来如何？",image_urls:[],total_token_count:3466},{agent_thoughts:[{created_at:1736798843,event:"long_term_memory_recall",id:"783ace3c-e797-48b1-bc5d-c6273e7e3862",latency:0,observation:"",position:1,thought:"",tool:"",tool_input:{}},{created_at:1736798843,event:"agent_thought",id:"f8670356-6be4-4852-a760-129143cd0462",latency:1.6321122000008472,observation:"",position:2,thought:'[{"name": "wf_llmops_workflow", "args": {"query": "LLMops相关内容"}, "id": "chatcmpl-cN782A0RQfI7wsBoJbyQIkd0Gh89c", "type": "tool_call"}]',tool:"",tool_input:{}},{created_at:1736798843,event:"agent_action",id:"c8f59ebd-a1ca-49da-a5b9-a9a779654b55",latency:4.944664399998146,observation:'{"workflow_output": "您好！看起来您的提问是关于LLMOps的，但具体内容似乎没有明确给出。LLMOps（Large Language Model Operations）是指管理和优化大规模语言模型生命周期的一系列实践和技术，包括但不限于模型训练、部署、监控、维护以及持续改进等方面。如果您有更具体的问题或想了解LLMOps中的某个特定方面，请告诉我，我很乐意为您提供更多信息！"}',position:3,thought:"",tool:"wf_llmops_workflow",tool_input:{query:"LLMops相关内容"}},{created_at:1736798843,event:"agent_message",id:"41a2e78a-58f8-4474-aaa9-ef48ea54ac76",latency:1.4676063000006252,observation:"",position:4,thought:"LLMOps（Large Language Model Operations）是指管理和优化大型语言模型生命周期的一系列实践和技术，包括模型训练、部署、监控、维护以及持续改进等方面。如果您有更具体的问题或想了解LLMOps中的某个特定方面，请告诉我，我很乐意为您提供更多信息！",tool:"",tool_input:{}}],answer:"LLMOps（Large Language Model Operations）是指管理和优化大型语言模型生命周期的一系列实践和技术，包括模型训练、部署、监控、维护以及持续改进等方面。如果您有更具体的问题或想了解LLMOps中的某个特定方面，请告诉我，我很乐意为您提供更多信息！",conversation_id:"73f1d3f4-9388-48a4-a49a-46acf090f653",created_at:1736798834,id:"3925533d-877e-4171-a381-66b37a7c225f",latency:8.044382899999619,query:"帮我调用wf_llmops_workflow()工具，查询LLMops",image_urls:[],total_token_count:1158}],c.value={current_page:1,page_size:20,total_page:1,total_record:2},n.value=!1}}}},Mt=()=>({handleDeleteConversation:(s,r)=>{et.warning({title:"要删除该会话么?",content:"删除会话信息后，删除会话后，该会话下的所有聊天记录将被永远删除，无法找回。",hideCancel:!1,onOk:async()=>{const g=await Ct(s);Q.success(g.message),r&&r()}})}}),$t=()=>{const n=p(!1);return{loading:n,handleUpdateConversationName:async(r,g)=>{try{n.value=!0;const c=await At(r,g);Q.success(c.message)}finally{n.value=!1}}}},Wt=()=>{const n=p(!1);return{loading:n,handleUpdateConversationIsPinned:async(r,g=!1,c)=>{try{n.value=!0;const m=await Lt(r,g);Q.success(m.message),c&&c()}finally{n.value=!1}}}},qt={class:"flex items-center justify-between"},St={class:"pt-6"},zt={class:"flex items-center justify-between"},Nt=Oe({__name:"UpdateNameModal",props:{conversation_id:{type:String,default:"",required:!1},visible:{type:Boolean,required:!0},success_callback:{type:Function,required:!1}},emits:["update:visible","update:conversation_id"],setup(n,{emit:s}){const r=n,g=s,{loading:c,handleUpdateConversationName:m}=$t(),C={name:""},h=p({...C}),U=p(),S=()=>g("update:visible",!1),k=async({errors:W})=>{W||(await m(r.conversation_id,h.value.name),r.success_callback&&r.success_callback(r.conversation_id,h.value.name),g("update:visible",!1))};return Fe(()=>r.visible,async W=>{var f;(f=U.value)==null||f.resetFields(),W||(h.value=C,g("update:conversation_id",""))}),(W,f)=>{const te=_("icon-close"),R=_("a-button"),ie=_("a-input"),y=_("a-form-item"),ce=_("a-space"),G=_("a-form"),L=_("a-modal");return b(),ee(L,{width:520,visible:r.visible,"hide-title":"",footer:!1,"modal-class":"rounded-xl",onCancel:S},{default:i(()=>[u("div",qt,[f[1]||(f[1]=u("div",{class:"text-lg font-bold text-gray-700"},"重命名",-1)),a(R,{type:"text",class:"!text-gray-700",size:"small",onClick:S},{icon:i(()=>[a(te)]),_:1})]),u("div",St,[a(G,{ref_key:"formRef",ref:U,model:h.value,layout:"vertical",onSubmit:k},{default:i(()=>[a(y,{field:"name",label:"会话名称","asterisk-position":"end",rules:[{required:!0,message:"会话名称不能为空"}]},{default:i(()=>[a(ie,{"model-value":h.value.name,"onUpdate:modelValue":f[0]||(f[0]=A=>h.value.name=A),placeholder:"请输入新会话名称"},null,8,["model-value"])]),_:1}),u("div",zt,[f[4]||(f[4]=u("div",{class:""},null,-1)),a(ce,{size:16},{default:i(()=>[a(R,{class:"rounded-lg",onClick:S},{default:i(()=>f[2]||(f[2]=[M("取消")])),_:1}),a(R,{loading:d(c),type:"primary","html-type":"submit",class:"rounded-lg"},{default:i(()=>f[3]||(f[3]=[M(" 确认 ")])),_:1},8,["loading"])]),_:1})])]),_:1},8,["model"])])]),_:1},8,["visible"])}}}),Pt={class:"flex min-h-screen h-full"},Ut={class:"w-[240px] flex-shrink-0 border-r border-gray-200 p-4 flex flex-col bg-white"},Ot={class:"flex items-center gap-3 mb-8 flex-shrink-0"},Ft={class:"flex-1 text-base font-semibold line-clamp-1 break-all text-gray-700"},Tt={class:"flex-1 overflow-scroll scrollbar-w-none"},Bt={class:"mb-4"},Qt={class:"flex flex-col gap-1"},Gt=["onClick"],jt={class:"flex-1 line-clamp-1 break-all"},Dt={class:"mb-4"},Vt={class:"flex flex-col gap-1"},Et={class:"flex-1 line-clamp-1 break-all"},Ht=["onClick"],Rt={class:"flex-1 line-clamp-1 break-all"},Jt={class:"flex-1 min-h-screen bg-white"},Kt={class:"h-16 leading-[64px] text-base font-semibold px-6 border-b"},Xt={class:"flex flex-col gap-6 py-6"},Yt={key:0,class:"h-[50px] flex items-center justify-center"},Zt={class:"flex flex-col items-center gap-2"},ea={class:"text-lg text-gray-700"},ta={key:0,class:"bg-gray-100 w-full px-4 py-3 rounded-lg text-gray-700"},aa={class:"flex items-center flex-wrap gap-2 w-full"},na=["onClick"],oa={class:"w-[600px] mx-auto flex flex-col flex-shrink-0"},sa={class:"px-6 flex items-center gap-4"},la={key:0,class:"flex items-center gap-2"},ia={class:"hidden group-hover:flex items-center justify-center bg-gray-700/50 w-10 h-10 absolute top-0"},ca={class:"flex items-center gap-2"},ra=["placeholder"],va=Oe({__name:"IndexView",setup(n){const s=it(),r=p(!1),g=p(""),c=p(null),m=p(""),C=p(""),h=p([]),U=p(null),S=p(!1);p(!1),p(null);const k=p(""),W=p(""),f=p(null),te=p(0),R=tt(),{loading:ie,web_app:y,loadWebApp:ce}=bt(),{loading:G,pinned_conversations:L,unpinned_conversations:A,loadWebAppConversations:Te}=wt(),{handleDeleteConversation:Be}=Mt(),{messages:x,loadConversationMessagesWithPage:re}=It(),{handleUpdateConversationIsPinned:Qe}=Wt(),{loading:j,handleWebAppChat:Ge}=yt(),{loading:je,handleStopWebAppChat:De}=xt(),{suggested_questions:_e,handleGenerateSuggestedQuestions:Ve}=ut(),ge=pe(()=>{var o,t,v;return y.value?(v=(t=(o=y.value)==null?void 0:o.app_config)==null?void 0:t.features)==null?void 0:v.includes("image_input"):!1}),Ee=pe(()=>{var o,t,v;return y.value?(v=(t=(o=y.value)==null?void 0:o.app_config)==null?void 0:t.speech_to_text)==null?void 0:v.enable:!1}),fe=pe(()=>{if(m.value==="new_conversation")return c.value;if(m.value!==""){const o=L.value.find(t=>t.id===m.value);return o||A.value.find(t=>t.id===m.value)}return null}),He=()=>{te.value=f.value.$el.scrollHeight},me=async(o,t)=>{const v=t?L.value[o]:A.value[o];await Qe(v.id,!t,()=>{t?(L.value.splice(o,1),A.value.push(v)):(A.value.splice(o,1),L.value.push(v))})},he=(o,t)=>{const v=t?L.value[o]:A.value[o];g.value=v.id,r.value=!0},Re=(o,t)=>{let v=L.value.findIndex($=>$.id===o);v!==-1?L.value[v].name=t:(v=A.value.findIndex($=>$.id===o),v!==-1&&(A.value[v].name=t))},be=async(o,t)=>{const v=t?L.value[o]:A.value[o];Be(v.id,()=>{t?L.value.splice(o,1):A.value.splice(o,1)})},ye=()=>{m.value="new_conversation",c.value||(c.value={id:"",name:"New Conversation",summary:"",created_at:0})},Je=()=>{f.value.$el.scrollTop=f.value.$el.scrollHeight-te.value},Ke=async o=>{const{scrollTop:t}=o.target;t<=0&&!j.value&&(He(),await re(fe.value.id,!1),Je())},ue=async()=>{var ae,q,D,J,z,K,X;if(C.value.trim()===""){Q.warning("用户提问不能为空");return}if(j.value){Q.warning("上一次提问还未结束，请稍等");return}_e.value=[],k.value="",W.value="";const o=gt.cloneDeep(m.value);x.value.unshift({id:"",conversation_id:"",query:C.value,image_urls:h.value,answer:"",total_token_count:0,latency:0,agent_thoughts:[],created_at:0});let t=0;const v=C.value,$=h.value;C.value="",h.value=[];const F={conversation_id:m.value==="new_conversation"?"":m.value,query:v,image_urls:$};await Ge(String((ae=s.params)==null?void 0:ae.token),F,N=>{var ne;const V=N==null?void 0:N.event,e=N==null?void 0:N.data,Y=e==null?void 0:e.id,P=x.value[0].agent_thoughts;if(k.value===""&&(e!=null&&e.message_id)&&(W.value=e==null?void 0:e.task_id,k.value=e==null?void 0:e.message_id,x.value[0].id=e==null?void 0:e.message_id,x.value[0].conversation_id=e==null?void 0:e.conversation_id),V!==se.ping){if(V===se.agentMessage){const T=P.findIndex(E=>(E==null?void 0:E.id)===Y);T===-1?(t+=1,P.push({id:Y,position:t,event:e==null?void 0:e.event,thought:e==null?void 0:e.thought,observation:e==null?void 0:e.observation,tool:e==null?void 0:e.tool,tool_input:e==null?void 0:e.tool_input,latency:e==null?void 0:e.latency,created_at:0})):P[T]={...P[T],thought:((ne=P[T])==null?void 0:ne.thought)+(e==null?void 0:e.thought),latency:e==null?void 0:e.latency},x.value[0].answer+=e==null?void 0:e.thought,x.value[0].latency=e==null?void 0:e.latency,x.value[0].total_token_count=e==null?void 0:e.total_token_count}else V===se.error?x.value[0].answer=e==null?void 0:e.observation:V===se.timeout?x.value[0].answer="当前Agent执行已超时，无法得到答案，请重试":(t+=1,P.push({id:Y,position:t,event:e==null?void 0:e.event,thought:e==null?void 0:e.thought,observation:e==null?void 0:e.observation,tool:e==null?void 0:e.tool,tool_input:e==null?void 0:e.tool_input,latency:e==null?void 0:e.latency,created_at:0}));x.value[0].agent_thoughts=P,f.value.scrollToBottom()}}),x.value.length>0&&(o==="new_conversation"&&(A.value.unshift({id:x.value[0].conversation_id,name:"New Conversation",summary:"",created_at:x.value[0].created_at}),c.value=null,m.value==="new_conversation"&&(m.value=x.value[0].conversation_id)),(D=(q=y.value)==null?void 0:q.app_config)!=null&&D.suggested_after_answer.enable&&k.value&&(Ve(k.value),setTimeout(()=>f.value&&f.value.scrollToBottom(),100)),(z=(J=y.value)==null?void 0:J.app_config)!=null&&z.text_to_speech.enable&&((X=(K=y.value)==null?void 0:K.app_config)!=null&&X.text_to_speech.auto_play)&&k.value)},de=async o=>{await xe(),m.value=o},xe=async()=>{var o;W.value===""||!j.value||await De(String((o=s.params)==null?void 0:o.token),W.value)},we=async o=>{C.value=o,await ue()},Xe=()=>{if(h.value.length>=5){Q.error("对话上传图片数量不能超过5张");return}U.value.click()},Ye=async o=>{var $;if(S.value)return;const v=($=o.target.files)==null?void 0:$[0];if(v)try{S.value=!0;const F=await ct(v);h.value.push(F.data.image_url),Q.success("上传图片成功")}finally{S.value=!1}};return Fe(()=>m.value,async o=>{o==="new_conversation"?x.value=[]:o!==""&&(await re(o,!0),await rt(()=>{f.value&&f.value.scrollToBottom()}))},{immediate:!0}),at(()=>{var t;const o=String((t=s.params)==null?void 0:t.token);Promise.all([ce(o),Te(o)]),ye(),re("",!0)}),nt(()=>{}),(o,t)=>{var T,E,ke,Ce,Ae,Le,Ie,Me,$e,We,qe,Se;const v=_("a-avatar"),$=_("a-skeleton-line"),F=_("a-skeleton"),ae=_("icon-edit"),q=_("a-button"),D=_("icon-message"),J=_("icon-more"),z=_("a-doption"),K=_("a-dropdown"),X=_("icon-empty"),N=_("a-empty"),V=_("icon-poweroff"),e=_("icon-close"),Y=_("icon-plus"),P=_("icon-loading");_("icon-voice"),_("icon-pause");const ne=_("icon-send");return b(),w("div",Pt,[u("div",Ut,[u("div",Ot,[a(v,{size:32,shape:"square","image-url":(T=d(y))==null?void 0:T.icon,class:"flex-shrink-0"},null,8,["image-url"]),u("div",Ft,[a(F,{loading:d(ie),animation:""},{default:i(()=>[a($,{rows:1,"line-height":32,"line-spacing":4})]),_:1},8,["loading"]),M(" "+O((E=d(y))==null?void 0:E.name),1)])]),a(q,{type:"primary",long:"",class:"rounded-lg mb-6 flex-shrink-0",onClick:ye},{icon:i(()=>[a(ae)]),default:i(()=>[t[4]||(t[4]=M(" 新增会话 "))]),_:1}),u("div",Tt,[u("div",Bt,[t[9]||(t[9]=u("div",{class:"text-gray-700 font-semibold mb-2"},"置顶会话",-1)),a(F,{loading:d(G),animation:""},{default:i(()=>[a($,{rows:2,"line-height":32,"line-spacing":4})]),_:1},8,["loading"]),u("div",Qt,[(b(!0),w(Z,null,oe(d(L),(l,I)=>(b(),w("div",{key:l.id,onClick:()=>de(l.id),class:H(`group flex items-center gap-1 h-8 leading-8 pl-3 pr-1 text-gray-700 rounded-lg cursor-pointer ${m.value===l.id?"bg-blue-50 !text-blue-700":""} hover:bg-blue-50 hover:text-blue-700`)},[a(D,{class:"flex-shrink-0"}),u("div",jt,O(l.name),1),a(K,{position:"br"},{content:i(()=>[a(z,{onClick:()=>me(I,!0)},{default:i(()=>t[5]||(t[5]=[M("取消置顶")])),_:2},1032,["onClick"]),a(z,{onClick:()=>he(I,!0)},{default:i(()=>t[6]||(t[6]=[M("重命名")])),_:2},1032,["onClick"]),a(z,{class:"text-red-700",onClick:()=>be(I,!0)},{default:i(()=>t[7]||(t[7]=[M(" 删除 ")])),_:2},1032,["onClick"])]),default:i(()=>[a(q,{size:"mini",type:"text",class:"!text-inherit !bg-transparent invisible group-hover:visible"},{icon:i(()=>[a(J)]),_:1})]),_:2},1024)],10,Gt))),128))]),!d(G)&&d(L).length===0?(b(),ee(N,{key:0},{image:i(()=>[a(X,{size:36})]),default:i(()=>[t[8]||(t[8]=M(" 暂无置顶会话 "))]),_:1})):B("",!0)]),u("div",Dt,[t[14]||(t[14]=u("div",{class:"text-gray-700 font-semibold mb-2"},"对话列表",-1)),a(F,{loading:d(G),animation:""},{default:i(()=>[a($,{rows:2,"line-height":32,"line-spacing":4})]),_:1},8,["loading"]),u("div",Vt,[c.value?(b(),w("div",{key:0,class:H(`group flex items-center gap-1 h-8 leading-8 pl-3 pr-1 text-gray-700 rounded-lg cursor-pointer ${m.value==="new_conversation"?"bg-blue-50 !text-blue-700":""} hover:bg-blue-50 hover:text-blue-700`),onClick:t[0]||(t[0]=()=>de("new_conversation"))},[a(D,{class:"flex-shrink-0"}),u("div",Et,O(c.value.name),1)],2)):B("",!0),(b(!0),w(Z,null,oe(d(A),(l,I)=>(b(),w("div",{key:l.id,onClick:()=>de(l.id),class:H(`group flex items-center gap-1 h-8 leading-8 pl-3 pr-1 text-gray-700 rounded-lg cursor-pointer ${m.value===l.id?"bg-blue-50 !text-blue-700":""} hover:bg-blue-50 hover:text-blue-700`)},[a(D,{class:"flex-shrink-0"}),u("div",Rt,O(l.name),1),a(K,{position:"br"},{content:i(()=>[a(z,{onClick:()=>me(I,!1)},{default:i(()=>t[10]||(t[10]=[M("置顶会话")])),_:2},1032,["onClick"]),a(z,{onClick:()=>he(I,!1)},{default:i(()=>t[11]||(t[11]=[M(" 重命名")])),_:2},1032,["onClick"]),a(z,{class:"text-red-700",onClick:()=>be(I,!1)},{default:i(()=>t[12]||(t[12]=[M(" 删除 ")])),_:2},1032,["onClick"])]),default:i(()=>[a(q,{size:"mini",type:"text",class:"!text-inherit !bg-transparent invisible group-hover:visible"},{icon:i(()=>[a(J)]),_:1})]),_:2},1024)],10,Ht))),128))]),!c.value&&!d(G)&&d(A).length===0?(b(),ee(N,{key:0},{image:i(()=>[a(X,{size:36})]),default:i(()=>[t[13]||(t[13]=M(" 暂无会话列表 "))]),_:1})):B("",!0)])])]),u("div",Jt,[u("div",Kt,O((ke=fe.value)==null?void 0:ke.name),1),d(x).length>0?(b(),w("div",{key:0,class:H(`flex flex-col px-6 w-[600px] mx-auto ${h.value.length>0?"h-[calc(100vh-220px)]":"h-[calc(100vh-170px)]"}`)},[a(d(_t),{ref_key:"scroller",ref:f,items:d(x).slice().reverse(),"min-item-size":1,onScroll:Ke,class:"h-full scrollbar-w-none"},{default:i(({item:l,active:I})=>[a(d(dt),{item:l,active:I,"data-index":l.id},{default:i(()=>{var ze,Ne,Pe;return[u("div",Xt,[a(pt,{query:l.query,image_urls:l.image_urls,account:d(R).account},null,8,["query","image_urls","account"]),a(vt,{message_id:l.id,enable_text_to_speech:(Pe=(Ne=(ze=d(y))==null?void 0:ze.app_config)==null?void 0:Ne.text_to_speech)==null?void 0:Pe.enable,agent_thoughts:l.agent_thoughts,answer:l.answer,app:{name:d(y).name,icon:d(y).icon},suggested_questions:l.id===k.value?d(_e):[],loading:l.id===k.value&&d(j),latency:l.latency,total_token_count:l.total_token_count,onSelectSuggestedQuestion:we,message_class:"max-w-[513px]"},null,8,["message_id","enable_text_to_speech","agent_thoughts","answer","app","suggested_questions","loading","latency","total_token_count"])])]}),_:2},1032,["item","active","data-index"])]),_:1},8,["items"]),W.value&&d(j)?(b(),w("div",Yt,[a(q,{loading:d(je),class:"rounded-lg px-2",onClick:xe},{icon:i(()=>[a(V)]),default:i(()=>[t[15]||(t[15]=M(" 停止响应 "))]),_:1},8,["loading"])])):B("",!0)],2)):(b(),w("div",{key:1,class:H(`flex flex-col p-6 gap-2 items-center justify-center w-[600px] mx-auto ${h.value.length>0?"h-[calc(100%-220px)] min-h-[calc(100vh-220px)]":"h-[calc(100%-170px)] min-h-[calc(100vh-170px)]"}`)},[u("div",Zt,[a(v,{size:48,shape:"square",class:"rounded-lg","image-url":(Ce=d(y))==null?void 0:Ce.icon},null,8,["image-url"]),u("div",ea,O((Ae=d(y))==null?void 0:Ae.name),1)]),(Ie=(Le=d(y))==null?void 0:Le.app_config)!=null&&Ie.opening_statement?(b(),w("div",ta,O(($e=(Me=d(y))==null?void 0:Me.app_config)==null?void 0:$e.opening_statement),1)):B("",!0),u("div",aa,[(b(!0),w(Z,null,oe((qe=(We=d(y))==null?void 0:We.app_config)==null?void 0:qe.opening_questions.filter(l=>l.trim()!==""),(l,I)=>(b(),w("div",{key:I,class:"px-4 py-1.5 border rounded-lg text-gray-700 cursor-pointer hover:bg-gray-50",onClick:async()=>await we(l)},O(l),9,na))),128))])],2)),u("div",oa,[u("div",sa,[u("div",{class:H(`${h.value.length>0?"h-[100px]":"h-[50px]"} flex flex-col justify-center gap-2 px-4 flex-1 border border-gray-200 rounded-[24px]`)},[h.value.length>0&&ge.value?(b(),w("div",la,[(b(!0),w(Z,null,oe(h.value,(l,I)=>(b(),w("div",{key:l,class:"w-10 h-10 relative rounded-lg overflow-hidden group cursor-pointer"},[a(v,{shape:"square","image-url":l},null,8,["image-url"]),u("div",ia,[a(e,{class:"text-white",onClick:()=>h.value.splice(I,1)},null,8,["onClick"])])]))),128))])):B("",!0),u("div",ca,[ot(u("input",{"onUpdate:modelValue":t[1]||(t[1]=l=>C.value=l),type:"text",class:"flex-1 outline-0",onKeyup:lt(ue,["enter"]),placeholder:`给 "${((Se=d(y))==null?void 0:Se.name)??'"聊天机器人"'}" 发送消息`},null,40,ra),[[st,C.value]]),u("input",{type:"file",ref_key:"fileInput",ref:U,accept:"image/*",onChange:Ye,class:"hidden"},null,544),ge.value?(b(),ee(q,{key:0,loading:S.value,size:"mini",type:"text",shape:"circle",class:"!text-gray-700",onClick:Xe},{icon:i(()=>[a(Y)]),_:1},8,["loading"])):B("",!0),Ee.value?(b(),ee(q,{key:2,size:"mini",type:"text",shape:"circle"},{icon:i(()=>[a(P)]),_:1})):(b(),w(Z,{key:1},[],64)),a(q,{loading:d(j),type:"text",shape:"circle",class:"!text-gray-700",onClick:ue},{icon:i(()=>[a(ne,{size:16})]),_:1},8,["loading"])])],2)]),t[16]||(t[16]=u("div",{class:"text-center text-gray-500 text-xs py-4"}," 内容由AI生成，无法确保真实准确，仅供参考。 ",-1))])]),a(Nt,{visible:r.value,"onUpdate:visible":t[2]||(t[2]=l=>r.value=l),conversation_id:g.value,"onUpdate:conversation_id":t[3]||(t[3]=l=>g.value=l),success_callback:Re},null,8,["visible","conversation_id"])])}}});export{va as default};
