import{A as d,B as u,b as o,k,v as c,M as h}from"./index-Be55BAY6.js";const y=e=>d("/workflows",{params:e}),W=e=>u("/workflows",{body:e}),v=(e,s)=>u(`/workflows/${e}`,{body:s}),_=e=>d(`/workflows/${e}`),b=e=>u(`/workflows/${e}/delete`),m=e=>d(`/workflows/${e}/draft-graph`),P=e=>u(`/workflows/${e}/publish`),C=e=>u(`/workflows/${e}/cancel-publish`),G=()=>{const e=o(!1),s=o([]),t={current_page:1,page_size:20,total_page:0,total_record:0},a=o({...t});return{loading:e,workflows:s,paginator:a,loadWorkflows:async(i="",f="",r=!1)=>{if(r)a.value=t;else if(a.value.current_page>a.value.total_page)return;try{e.value=!0;const n=(await y({current_page:a.value.current_page,page_size:a.value.page_size,search_word:i,status:f})).data;a.value=n.paginator,a.value.current_page<=a.value.total_page&&(a.value.current_page+=1),r?s.value=n.list:s.value.push(...n.list)}finally{s.value=[{id:"11",name:"小红书文案生成",tool_call_name:"WorkflowName",icon:"https://www.yimiaotui.com/d/image/20230427/98ed757ec1b322e69fb9e5afcfb275c2.jpg",description:"这是一个可以根据特定主体生成小红书文案的工作流，传递对应的query即可。",status:"published",is_debug_passed:!0,node_count:1,published_at:1742704861,updated_at:1742704861,created_at:1742704861}],e.value=!1}}}},$=()=>{const e=o(!1),s=k();return{loading:e,handleCreateWorkflow:async a=>{try{e.value=!0;const l=await W(a);c.success("创建工作流成功"),await s.push({name:"space-workflows-detail",params:{workflow_id:l.data.id}})}finally{e.value=!1}}}},z=()=>{const e=o(!1);return{loading:e,handleUpdateWorkflow:async(t,a)=>{try{e.value=!0;const l=await v(t,a);c.success(l.message)}finally{e.value=!1}}}},A=()=>{const e=o(!1),s=o({});return{loading:e,workflow:s,loadWorkflow:async a=>{try{e.value=!0;const l=await _(a);s.value=l.data}finally{s.value={id:"11",name:"小红书文案生成",tool_call_name:"WorkflowName",icon:"https://www.yimiaotui.com/d/image/20230427/98ed757ec1b322e69fb9e5afcfb275c2.jpg",description:"这是一个可以根据特定主体生成小红书文案的工作流，传递对应的query即可。",status:"published",is_debug_passed:!0,node_count:1,published_at:1742704861,updated_at:1742704861,created_at:1742704861},e.value=!1}}}},M=()=>({handleDeleteWorkflow:(s,t)=>{h.warning({title:"要删除该工作流吗?",content:"删除工作流后，发布的WebApp、开放API以及关联的社交媒体平台均无法使用该工作流，如果需要暂停工作流，可使用取消发布功能。",hideCancel:!1,onOk:async()=>{try{const a=await b(s);c.success(a.message)}finally{t&&t()}}})}}),U=()=>{const e=o(!1),s=o([]),t=o([]);return{loading:e,nodes:s,edges:t,loadDraftGraph:async l=>{try{e.value=!0;const f=(await m(l)).data;s.value=f.nodes.map(r=>{const{id:w,node_type:n,position:p,...g}=r;return{id:w,type:n,position:p,data:g}}),t.value=f.edges.map(r=>({...r,animated:!0,style:{strokeWidth:2,stroke:"#9ca3af"}}))}finally{e.value=!1}}}},j=()=>{const e=o(!1);return{loading:e,handlePublishWorkflow:async t=>{try{e.value=!0;const a=await P(t);c.success(a.message)}finally{e.value=!1}}}},q=()=>{const e=o(!1);return{loading:e,handleCancelPublish:async t=>{try{e.value=!0;const a=await C(t);c.success(a.message)}finally{e.value=!1}}}};export{z as a,A as b,G as c,M as d,U as e,j as f,q as g,$ as u};
