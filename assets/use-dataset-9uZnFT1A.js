import{A as m,r as p,E as g,o as y,y as h,M as _,L as w}from"./index-BJog29LW.js";import{j as v,k as z,l as P,g as S,m as U,a as q,n as O,o as j,p as M,q as W,r as E,s as G}from"./dataset-D-rvlYHr.js";const L=()=>{const l=m(),s=p(!1),a=g([]),t={current_page:1,page_size:20,total_page:0,total_record:0},e=g({...t}),r=async(o=!1)=>{var c;if(o)n();else if(e.current_page>e.total_page)return;try{s.value=!0;const d=(await v(e.current_page,e.page_size,String(((c=l.query)==null?void 0:c.search_word)??""))).data;i(d),e.current_page<=e.total_page&&(e.current_page+=1),o?a.splice(0,a.length,...d.list):a.push(...d.list)}finally{s.value=!1}},n=()=>{Object.assign(e,{...t})},i=o=>{e.current_page=o.current_page,e.page_size=o.page_size,e.total_page=o.total_page,e.total_record=o.total_record};return y(async()=>{await r(!0)}),h(()=>{var o;return(o=l.query)==null?void 0:o.search_word},async()=>{await r(!0)}),{loading:s,datasets:a,paginator:e,loadDatasets:r}},R=()=>({handleDelete:(s,a)=>{w.warning({title:"要删除知识库吗?",content:"删除知识库后，关联该知识库的应用将无法再使用该知识库，所有的提示配置和文档都将被永久删除",hideCancel:!1,onOk:async()=>{try{const t=await j(s);_.success(t.message)}finally{a&&a()}}})}}),x=()=>{const l=p(!1),a=g({...{fileList:[],icon:"",name:"",description:""}}),t=p(),e=p(!1);return{loading:l,form:a,formRef:t,saveDataset:async i=>{try{if(l.value=!0,i!==void 0&&i!==""){const o=await z(i,{icon:a.icon,name:a.name,description:a.description});_.success(o.message)}else{const o=await P({icon:a.icon,name:a.name,description:a.description});_.success(o.message)}}finally{l.value=!1}},showUpdateModal:e,updateShowUpdateModal:(i,o)=>{e.value=i,o&&o()}}},A=l=>{const s=p(!1),a=g({}),t=async e=>{try{s.value=!0;const n=(await S(e)).data;Object.assign(a,{...n})}finally{s.value=!1}};return y(()=>t(l)),{loading:s,dataset:a,loadDataset:t}},B=l=>{const s=m(),a=p(!1),t=g([]),e={current_page:1,page_size:20,total_page:0,total_record:0},r=g({...e}),n=async(c=!1)=>{var u,d,f;if(!(!c&&r.current_page>r.total_page))try{a.value=!0;const D=(await U(l,{current_page:((u=s.query)==null?void 0:u.current_page)||1,page_size:((d=s.query)==null?void 0:d.page_size)||20,search_word:((f=s.query)==null?void 0:f.search_word)||""})).data;o(D),t.splice(0,t.length,...D.list)}finally{a.value=!1}},i=()=>{Object.assign(r,{...e})},o=c=>{r.current_page=c.paginator.current_page,r.page_size=c.paginator.page_size,r.total_page=c.paginator.total_page,r.total_record=c.paginator.total_record};return y(async()=>{await n(!0)}),h(()=>s.query,async(c,u)=>{c.search_word!==u.search_word?(i(),await n(!0)):c.current_page!==u.current_page&&await n()}),{loading:a,documents:t,paginator:r,loadDocuments:n}},H=()=>({handleDelete:(s,a,t)=>{w.warning({title:"要删除该文档吗?",content:"删除文档后，数据库/向量数据库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁言功能",hideCancel:!1,onOk:async()=>{try{const e=await M(s,a);_.success(e.message)}finally{t&&t()}}})}}),I=()=>({handleUpdate:async(s,a,t,e)=>{try{const r=await W(s,a,t);_.success(r.message)}finally{e&&e()}}}),J=(l,s)=>{const a=p(!1),t=g({}),e=async(r,n)=>{try{a.value=!0;const o=(await q(r,n)).data;Object.assign(t,{...o})}finally{a.value=!1}};return y(async()=>await e(l,s)),{loading:a,document:t,loadDocument:e}},K=(l,s)=>{const a=m(),t=p(!1),e=g([]),r={current_page:1,page_size:20,total_page:0,total_record:0},n=g({...r}),i=async(c=!1)=>{var u;if(c)Object.assign(n,{...r});else if(n.current_page>n.total_page)return;try{t.value=!0;const f=(await O(l,s,{current_page:n.current_page,page_size:n.page_size,search_word:String(((u=a.query)==null?void 0:u.search_word)||"")})).data;o(f),n.current_page<=n.total_page&&(n.current_page+=1),c?e.splice(0,e.length,...f.list):e.push(...f.list)}finally{t.value=!1}},o=c=>{n.current_page=c.paginator.current_page,n.page_size=c.paginator.page_size,n.total_page=c.paginator.total_page,n.total_record=c.paginator.total_record};return y(async()=>{await i(!0)}),h(()=>{var c;return(c=a.query)==null?void 0:c.search_word},async()=>{await i(!0)}),{loading:t,segments:e,paginator:n,loadSegments:i}},N=()=>({handleDelete:async(s,a,t,e)=>{w.warning({title:"要删除该文档片段吗？",content:"删除文档片段后，知识库/向量知识库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁用功能。",hideCancel:!1,onOk:async()=>{try{const r=await E(s,a,t);_.success(r.message)}finally{e&&e()}}})}}),T=()=>({handleUpdate:async(s,a,t,e,r)=>{try{const n=await G(s,a,t,e);_.success(n.message)}finally{r&&r()}}});export{x as a,R as b,A as c,B as d,H as e,I as f,J as g,K as h,N as i,T as j,L as u};
