import{k as y,r as l,p as g,q as f,h as D,v as _,M as w}from"./index-DGwnYLwc.js";import{c as b,d as v,e as O,g as z,f as M,i as P,j,k as q}from"./dataset-CVxg7v4t.js";const J=()=>{const r=y(),t=l(!1),e=g([]),s={current_page:1,page_size:20,total_page:0,total_record:0},a=g({...s}),c=async(n=!1)=>{var o;if(n)i();else if(a.current_page>a.total_page)return;try{t.value=!0;const p=(await b(a.current_page,a.page_size,String(((o=r.query)==null?void 0:o.search_word)??""))).data;d(p),a.current_page<=a.total_page&&(a.current_page+=1),n?e.splice(0,e.length,...p.list):e.push(...p.list)}finally{Object.assign(e,[{id:"46db30d1-3199-4e79-a0cd-abf12fa6858f",name:"慕课LLMOps知识库",icon:"https://cdn.imooc.com/dataset.png",description:"JavaScript是一种高级编程语言，用于创建交互式网页和动态效果，JavaScript在前端开发中扮演着非常重要的角色，因此学习 JavaScript 对于初级前端工程师来说非常必要。JavaScrip...",document_count:10,character_count:14651,related_app_count:2,updated_at:1721460914,created_at:1721460914}]),t.value=!1}},i=()=>{Object.assign(a,{...s})},d=n=>{a.current_page=n.current_page,a.page_size=n.page_size,a.total_page=n.total_page,a.total_record=n.total_record};return f(async()=>{await c(!0)}),D(()=>{var n;return(n=r.query)==null?void 0:n.search_word},async()=>{await c(!0)}),{loading:t,datasets:e,paginator:a,loadDatasets:c}},W=()=>({handleDelete:(t,e)=>{w.warning({title:"要删除知识库吗?",content:"删除知识库后，关联该知识库的应用将无法再使用该知识库，所有的提示配置和文档都将被永久删除",hideCancel:!1,onOk:async()=>{try{const s=await P(t);_.success(s.message)}finally{e&&e()}}})}}),C=()=>{const r=l(!1),e=g({...{fileList:[],icon:"",name:"",description:""}}),s=l(),a=l(!1);return{loading:r,form:e,formRef:s,saveDataset:async d=>{try{if(r.value=!0,d!==void 0&&d!==""){const n=await v(d,{icon:e.icon,name:e.name,description:e.description});_.success(n.message)}else{const n=await O({icon:e.icon,name:e.name,description:e.description});_.success(n.message)}}finally{r.value=!1}},showUpdateModal:a,updateShowUpdateModal:(d,n)=>{a.value=d,n&&n()}}},G=r=>{const t=l(!1),e=g({}),s=async a=>{try{t.value=!0;const i=(await z(a)).data;Object.assign(e,{...i})}finally{Object.assign(e,{id:"46db30d1-3199-4e79-a0cd-abf12fa6858f",name:"慕课LLMOps知识库",icon:"https://cdn.imooc.com/dataset.png",description:"",document_count:10,character_count:14651,hit_count:10,related_app_count:2,updated_at:1721460914,created_at:1721460914}),t.value=!1}};return f(()=>s(r)),{loading:t,dataset:e,loadDataset:s}},E=r=>{const t=y(),e=l(!1),s=g([]),a={current_page:1,page_size:20,total_page:0,total_record:0},c=g({...a}),i=async(o=!1)=>{var u,p,m;if(!(!o&&c.current_page>c.total_page))try{e.value=!0;const h=(await M(r,{current_page:((u=t.query)==null?void 0:u.current_page)||1,page_size:((p=t.query)==null?void 0:p.page_size)||20,search_word:((m=t.query)==null?void 0:m.search_word)||""})).data;n(h),s.splice(0,s.length,...h.list)}finally{s.push({id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",name:"LLMOps项目提示词",character_count:4700,hit_count:0,position:21,enabled:!0,disabled_at:0,status:"completed",error:"",updated_at:1726949586,created_at:1726949586},{id:"bde70d64-cbcc-47e7-a0f5-b51200b87c7c",name:"embedding提示",character_count:2310,hit_count:0,position:11,enabled:!1,disabled_at:0,status:"error",error:"",updated_at:1726949586,created_at:1726949586}),Object.assign(c,{current_page:1,page_size:20,total_page:1,total_record:2}),e.value=!1}},d=()=>{Object.assign(c,{...a})},n=o=>{c.current_page=o.paginator.current_page,c.page_size=o.paginator.page_size,c.total_page=o.paginator.total_page,c.total_record=o.paginator.total_record};return f(async()=>{await i(!0)}),D(()=>t.query,async(o,u)=>{o.search_word!==u.search_word?(d(),await i(!0)):o.current_page!==u.current_page&&await i()}),{loading:e,documents:s,paginator:c,loadDocuments:i}},F=()=>({handleDelete:(t,e,s)=>{w.warning({title:"要删除该文档吗?",content:"删除文档后，数据库/向量数据库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁言功能",hideCancel:!1,onOk:async()=>{try{const a=await j(t,e);_.success(a.message)}finally{s&&s()}}})}}),R=()=>({handleUpdate:async(t,e,s,a)=>{try{const c=await q(t,e,s);_.success(c.message)}finally{a&&a()}}});export{C as a,W as b,G as c,E as d,F as e,R as f,J as u};
