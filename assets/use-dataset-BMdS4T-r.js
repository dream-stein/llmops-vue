import{A as y,r as u,H as p,o as m,y as h,M as d,P as w}from"./index-LczBZ9Cq.js";import{e as v,f as S,i as P,g as z,j as U,a as q,k as O,l as j,m as C,n as M,o as G,p as W,q as b,r as E,s as F}from"./dataset-BIQsQIeO.js";const H=()=>{const r=y(),s=u(!1),a=p([]),t={current_page:1,page_size:20,total_page:0,total_record:0},e=p({...t}),n=async(c=!1)=>{var l;if(c)o();else if(e.current_page>e.total_page)return;try{s.value=!0;const _=(await v(e.current_page,e.page_size,String(((l=r.query)==null?void 0:l.search_word)??""))).data;i(_),e.current_page<=e.total_page&&(e.current_page+=1),c?a.splice(0,a.length,..._.list):a.push(..._.list)}finally{s.value=!1}},o=()=>{Object.assign(e,{...t})},i=c=>{e.current_page=c.current_page,e.page_size=c.page_size,e.total_page=c.total_page,e.total_record=c.total_record};return m(async()=>{await n(!0)}),h(()=>{var c;return(c=r.query)==null?void 0:c.search_word},async()=>{await n(!0)}),{loading:s,datasets:a,paginator:e,loadDatasets:n}},L=()=>({handleDelete:(s,a)=>{w.warning({title:"要删除知识库吗?",content:"删除知识库后，关联该知识库的应用将无法再使用该知识库，所有的提示配置和文档都将被永久删除",hideCancel:!1,onOk:async()=>{try{const t=await G(s);d.success(t.message)}finally{a&&a()}}})}}),B=()=>{const r=u(!1),a=p({...{fileList:[],icon:"",name:"",description:""}}),t=u(),e=u(!1);return{loading:r,form:a,formRef:t,saveDataset:async i=>{try{if(r.value=!0,i!==void 0&&i!==""){const c=await S(i,{icon:a.icon,name:a.name,description:a.description});d.success(c.message)}else{const c=await P({icon:a.icon,name:a.name,description:a.description});d.success(c.message)}}finally{r.value=!1}},showUpdateModal:e,updateShowUpdateModal:(i,c)=>{e.value=i,c&&c()}}},I=r=>{const s=u(!1),a=p({}),t=async e=>{try{s.value=!0;const o=(await z(e)).data;Object.assign(a,{...o})}finally{s.value=!1}};return m(()=>t(r)),{loading:s,dataset:a,loadDataset:t}},J=r=>{const s=y(),a=u(!1),t=p([]),e={current_page:1,page_size:20,total_page:0,total_record:0},n=p({...e}),o=async(l=!1)=>{var g,_,f;if(!(!l&&n.current_page>n.total_page))try{a.value=!0;const D=(await U(r,{current_page:((g=s.query)==null?void 0:g.current_page)||1,page_size:((_=s.query)==null?void 0:_.page_size)||20,search_word:((f=s.query)==null?void 0:f.search_word)||""})).data;c(D),t.splice(0,t.length,...D.list)}finally{a.value=!1}},i=()=>{Object.assign(n,{...e})},c=l=>{n.current_page=l.paginator.current_page,n.page_size=l.paginator.page_size,n.total_page=l.paginator.total_page,n.total_record=l.paginator.total_record};return m(async()=>{await o(!0)}),h(()=>s.query,async(l,g)=>{l.search_word!==g.search_word?(i(),await o(!0)):l.current_page!==g.current_page&&await o()}),{loading:a,documents:t,paginator:n,loadDocuments:o}},K=()=>({handleDelete:(s,a,t)=>{w.warning({title:"要删除该文档吗?",content:"删除文档后，数据库/向量数据库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁言功能",hideCancel:!1,onOk:async()=>{try{const e=await W(s,a);d.success(e.message)}finally{t&&t()}}})}}),N=()=>({handleUpdate:async(s,a,t,e)=>{try{const n=await b(s,a,t);d.success(n.message)}finally{e&&e()}}}),T=(r,s)=>{const a=u(!1),t=p({}),e=async(n,o)=>{try{a.value=!0;const c=(await q(n,o)).data;Object.assign(t,{...c})}finally{a.value=!1}};return m(async()=>await e(r,s)),{loading:a,document:t,loadDocument:e}},V=(r,s)=>{const a=y(),t=u(!1),e=p([]),n={current_page:1,page_size:20,total_page:0,total_record:0},o=p({...n}),i=async(l=!1)=>{var g;if(l)Object.assign(o,{...n});else if(o.current_page>o.total_page)return;try{t.value=!0;const f=(await O(r,s,{current_page:o.current_page,page_size:o.page_size,search_word:String(((g=a.query)==null?void 0:g.search_word)||"")})).data;c(f),o.current_page<=o.total_page&&(o.current_page+=1),l?e.splice(0,e.length,...f.list):e.push(...f.list)}finally{t.value=!1}},c=l=>{o.current_page=l.paginator.current_page,o.page_size=l.paginator.page_size,o.total_page=l.paginator.total_page,o.total_record=l.paginator.total_record};return m(async()=>{await i(!0)}),h(()=>{var l;return(l=a.query)==null?void 0:l.search_word},async()=>{await i(!0)}),{loading:t,segments:e,paginator:o,loadSegments:i}},X=()=>({handleDelete:async(s,a,t,e)=>{w.warning({title:"要删除该文档片段吗？",content:"删除文档片段后，知识库/向量知识库将无法检索到该文档，如需暂时关闭该文档的检索，可以选择禁用功能。",hideCancel:!1,onOk:async()=>{try{const n=await E(s,a,t);d.success(n.message)}finally{e&&e()}}})}}),Y=()=>({handleUpdate:async(s,a,t,e,n)=>{try{const o=await F(s,a,t,e);d.success(o.message)}finally{n&&n()}}}),Z=()=>{const r=u(!1);return{loading:r,handleCreateSegment:async(a,t,e)=>{try{r.value=!0;const n=await j(a,t,e);d.success(n.message)}finally{r.value=!1}}}},$=()=>{const r=u(!1);return{loading:r,handleUpdateSegment:async(a,t,e,n)=>{try{r.value=!0;const o=await C(a,t,e,n);d.success(o.message)}finally{r.value=!1}}}},k=()=>{const r=u(!1),s=u({});return{loading:r,segment:s,loadSegment:async(t,e,n)=>{try{r.value=!0;const o=await M(t,e,n);s.value=o.data}finally{r.value=!1}}}};export{B as a,L as b,I as c,J as d,K as e,N as f,Z as g,$ as h,k as i,T as j,V as k,X as l,Y as m,H as u};
