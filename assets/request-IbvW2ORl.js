import{v as h}from"./index-ClGKJAwE.js";const l="http://127.0.0.1:8080",f={success:0,fail:1,notFound:2,unauthorized:3,forbidden:4,validateError:5},j={str:"字符串",int:"整型",float:"浮点型",bool:"布尔值"},u=1e5,b={method:"GET",mode:"cors",credentials:"include",headers:new Headers({"Content-Type":"application/json"}),redirect:"follow"},g=(e,s)=>{const n=Object.assign({},b,s);let r=`${l}${e.startsWith("/")?e:`/${e}`}`;const{method:m,params:i,body:d}=n;if(m==="GET"&&i){const o=[];Object.keys(i).forEach(t=>{o.push(`${t}=${encodeURIComponent(i[t])}`)}),r.search(/\?/)===-1?r+=`?${o.join("&")}`:r+=`&${o.join("&")}`,delete n.params}return d&&(n.body=JSON.stringify(d)),Promise.race([new Promise((o,t)=>{setTimeout(()=>{t("接口已超时")},u)}),new Promise((o,t)=>{globalThis.fetch(r,n).then(async a=>{const c=await a.json();c.code===f.success?o(c):(h.error(c.message),t(new Error(c.message)))}).catch(a=>{h.error(a.message),t(a)})})])},p=(e,s={})=>g(e,s),O=(e,s={})=>p(e,Object.assign({},s,{method:"GET"})),y=(e,s={})=>p(e,Object.assign({},s,{method:"POST"}));export{O as g,y as p,j as t};
