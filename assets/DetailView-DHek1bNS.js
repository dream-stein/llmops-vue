import{d as C,b as y,o as f,f as v,g as t,h as o,w as r,v as S,u as i,c as T,a as x,i as w,G as j,H as q,x as h,r as n,j as G}from"./index-BUszeDqf.js";import{e as k,f as M,g as O}from"./use-app-BxaZZroA.js";const R={class:"flex flex-col h-full"},E={class:"flex items-center justify-between px-4 mb-4"},F={class:"flex flex-col"},H={key:0,class:"mb-4 flex flex-col"},I={class:"max-h-[321px] overflow-scroll scrollbar-w-none mb-2 text-gray-700 whitespace-pre-line"},J={class:""},K={class:"h-[50px] flex items-center gap-2 px-4 flex-1 border border-gray-200 rounded-full"},L={class:"flex-1"},Q=C({__name:"PresetPromptTextarea",props:{app_id:{type:String,required:!0},preset_prompt:{type:String,required:!0}},emits:["update:preset_prompt"],setup(b,{emit:c}){const p=b,g=c,l=y(!1),u=y(""),{handleUpdateDraftAppConfig:s}=k(),{loading:m,optimize_prompt:a,handleOptimizePrompt:z}=M(),V=()=>{if(a.value.trim()===""){h.warning("优化prompt为空，请重新生成");return}g("update:preset_prompt",a.value),s(p.app_id,{preset_prompt:a.value}),l.value=!1},D=async()=>{if(u.value.trim()===""){h.warning("原始prompt不能为空");return}await z(a.value)};return(te,e)=>{const $=n("icon-sync"),_=n("a-button"),A=n("a-space"),P=n("icon-send"),U=n("a-card"),B=n("a-trigger"),N=n("a-textarea");return f(),v("div",R,[t("div",E,[e[8]||(e[8]=t("div",{class:"text-gray-700 font-bold"},"人设与回复逻辑",-1)),o(B,{"popup-visible":l.value,"onUpdate:popupVisible":e[2]||(e[2]=d=>l.value=d),trigger:["click"],position:"bl","popup-translate":[0,8]},{content:r(()=>[o(U,{class:"rounded-lg w-[422px]"},{default:r(()=>[t("div",F,[u.value?(f(),v("div",H,[t("div",I,S(i(a)),1),i(m)?w("",!0):(f(),T(A,{key:0},{default:r(()=>[o(_,{size:"small",type:"primary",class:"rounded-lg",onClick:V},{default:r(()=>e[6]||(e[6]=[x(" 替换 ")])),_:1}),o(_,{size:"small",class:"rounded-lg",onClick:e[0]||(e[0]=d=>l.value=!1)},{default:r(()=>e[7]||(e[7]=[x("退出")])),_:1})]),_:1}))])):w("",!0),t("div",J,[t("div",K,[j(t("input",{"onUpdate:modelValue":e[1]||(e[1]=d=>u.value=d),type:"text",class:"flex-1 outline-0",placeholder:"你希望如何编写或优化提示词"},null,512),[[q,u.value]]),o(_,{loading:i(m),type:"text",shape:"circle",onClick:D},{icon:r(()=>[o(P,{size:16,class:"!text-blue-700"})]),_:1},8,["loading"])])])])]),_:1})]),default:r(()=>[o(_,{size:"mini",class:"rounded-lg px-2"},{icon:r(()=>[o($)]),default:r(()=>[e[5]||(e[5]=x(" 优化 "))]),_:1})]),_:1},8,["popup-visible"])]),t("div",L,[o(N,{class:"h-full resize-none !bg-transparent !border-0 text-gray-700 px-1",placeholder:"请在这里输入Agent的人设与回复逻辑(预设prompt)","max-length":2e3,"show-word-limit":"","model-value":p.preset_prompt,"onUpdate:modelValue":e[3]||(e[3]=d=>g("update:preset_prompt",d)),onBlur:e[4]||(e[4]=async()=>{await i(s)(p.app_id,{preset_prompt:p.preset_prompt})})},null,8,["model-value"])])])}}}),W={class:"flex-1 w-full min-h-0 bg-white"},X={class:"flex-1 grid grid-cols-[26fr_14fr] h-full w-full"},Y={class:"bg-gray-50 flex flex-col h-full"},Z={class:"grid grid-cols-[13fr_13fr] overflow-hidden h-[calc(100vh-141px)]"},ee={class:"border-r py-4"},re=C({__name:"DetailView",setup(b){var l;const c=G(),{draftAppConfigForm:p,loadDraftAppConfig:g}=O((l=c.params)==null?void 0:l.app_id);return k(),(u,s)=>{var m;return f(),v("div",W,[t("div",X,[t("div",Y,[s[2]||(s[2]=t("div",{class:"flex items-center h-16 border-b p-4"},[t("div",{class:"text-lg text-gray-700"},"应用编排")],-1)),t("div",Z,[t("div",ee,[o(Q,{preset_prompt:i(p).preset_prompt,"onUpdate:preset_prompt":s[0]||(s[0]=a=>i(p).preset_prompt=a),app_id:(m=i(c).params)==null?void 0:m.app_id},null,8,["preset_prompt","app_id"])]),s[1]||(s[1]=t("div",{class:""},"右侧应用能力",-1))])]),s[3]||(s[3]=t("div",{class:"min-w-[404px] bg-red-50"},"调试会话",-1))])])}}});export{re as default};
